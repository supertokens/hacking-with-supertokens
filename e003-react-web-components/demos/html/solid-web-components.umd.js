(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(":root{font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;color-scheme:light dark;color:#ffffffde;background-color:#242424;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}a{font-weight:500;color:#646cff;text-decoration:inherit}a:hover{color:#535bf2}body{margin:0;display:flex;place-items:center;min-width:320px;min-height:100vh}h1{font-size:3.2em;line-height:1.1}button{font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;border-radius:8px;border:1px solid transparent;padding:.6em 1.2em;font-size:1em;font-weight:500;font-family:inherit;background-color:#1a1a1a;cursor:pointer;transition:border-color .25s;color:#ffffffde}button:hover{border-color:#646cff}button:focus,button:focus-visible{outline:4px auto -webkit-focus-ring-color}@media (prefers-color-scheme: light){:root{color:#213547;background-color:#fff}a:hover{color:#747bff}button{background-color:#f9f9f9}}.form-wrap{display:flex;flex-direction:column;gap:1em}.form-wrap input{font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;border:1px solid #646cff;border-radius:8px;padding:.6em 1em;font-size:1em;font-family:inherit}div.wrapper{display:flex;flex-direction:column;gap:1em;height:100vh;width:100vw;font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;color-scheme:light dark;color:#ffffffde;background-color:#242424;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}div.wrapper header{height:80px;background:#f93;display:flex;align-items:center;justify-content:center}div.wrapper main{flex-grow:1;display:flex;align-items:center;justify-content:center;min-width:60%}div.wrapper footer{height:60px;background:#1f1f1f;display:flex;align-items:center;justify-content:center}")),document.head.appendChild(e)}}catch(i){console.error("vite-plugin-css-injected-by-js",i)}})();
(function(cn){typeof define=="function"&&define.amd?define(cn):cn()})(function(){"use strict";const kt={equals:(e,r)=>e===r};let zn=er;const _e=1,Rt=2,Jn={owned:null,cleanups:null,context:null,owner:null};var re=null;let dn=null,ps=null,Y=null,ee=null,be=null,It=0;function ms(e,r){const t=Y,i=re,o=e.length===0,n=r===void 0?i:r,a=o?Jn:{owned:null,cleanups:null,context:n?n.context:null,owner:n},u=o?e:()=>e(()=>Ye(()=>Et(a)));re=a,Y=null;try{return et(u,!0)}finally{Y=t,re=i}}function St(e,r){r=r?Object.assign({},kt,r):kt;const t={value:e,observers:null,observerSlots:null,comparator:r.equals||void 0},i=o=>(typeof o=="function"&&(o=o(t.value)),Zn(t,o));return[Yn.bind(t),i]}function fn(e,r,t){const i=hn(e,r,!1,_e);Ze(i)}function Kn(e,r,t){zn=bs;const i=hn(e,r,!1,_e);i.user=!0,be?be.push(i):Ze(i)}function Qn(e,r,t){t=t?Object.assign({},kt,t):kt;const i=hn(e,r,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=t.equals||void 0,Ze(i),Yn.bind(i)}function Ye(e){if(Y===null)return e();const r=Y;Y=null;try{return e()}finally{Y=r}}function Yn(){if(this.sources&&this.state)if(this.state===_e)Ze(this);else{const e=ee;ee=null,et(()=>_t(this),!1),ee=e}if(Y){const e=this.observers?this.observers.length:0;Y.sources?(Y.sources.push(this),Y.sourceSlots.push(e)):(Y.sources=[this],Y.sourceSlots=[e]),this.observers?(this.observers.push(Y),this.observerSlots.push(Y.sources.length-1)):(this.observers=[Y],this.observerSlots=[Y.sources.length-1])}return this.value}function Zn(e,r,t){let i=e.value;return(!e.comparator||!e.comparator(i,r))&&(e.value=r,e.observers&&e.observers.length&&et(()=>{for(let o=0;o<e.observers.length;o+=1){const n=e.observers[o],a=dn&&dn.running;a&&dn.disposed.has(n),(a?!n.tState:!n.state)&&(n.pure?ee.push(n):be.push(n),n.observers&&tr(n)),a||(n.state=_e)}if(ee.length>1e6)throw ee=[],new Error},!1)),r}function Ze(e){if(!e.fn)return;Et(e);const r=It;ws(e,e.value,r)}function ws(e,r,t){let i;const o=re,n=Y;Y=re=e;try{i=e.fn(r)}catch(a){return e.pure&&(e.state=_e,e.owned&&e.owned.forEach(Et),e.owned=null),e.updatedAt=t+1,nr(a)}finally{Y=n,re=o}(!e.updatedAt||e.updatedAt<=t)&&(e.updatedAt!=null&&"observers"in e?Zn(e,i):e.value=i,e.updatedAt=t)}function hn(e,r,t,i=_e,o){const n={fn:e,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:r,owner:re,context:re?re.context:null,pure:t};return re===null||re!==Jn&&(re.owned?re.owned.push(n):re.owned=[n]),n}function Tt(e){if(e.state===0)return;if(e.state===Rt)return _t(e);if(e.suspense&&Ye(e.suspense.inFallback))return e.suspense.effects.push(e);const r=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<It);)e.state&&r.push(e);for(let t=r.length-1;t>=0;t--)if(e=r[t],e.state===_e)Ze(e);else if(e.state===Rt){const i=ee;ee=null,et(()=>_t(e,r[0]),!1),ee=i}}function et(e,r){if(ee)return e();let t=!1;r||(ee=[]),be?t=!0:be=[],It++;try{const i=e();return ys(t),i}catch(i){t||(be=null),ee=null,nr(i)}}function ys(e){if(ee&&(er(ee),ee=null),e)return;const r=be;be=null,r.length&&et(()=>zn(r),!1)}function er(e){for(let r=0;r<e.length;r++)Tt(e[r])}function bs(e){let r,t=0;for(r=0;r<e.length;r++){const i=e[r];i.user?e[t++]=i:Tt(i)}for(r=0;r<t;r++)Tt(e[r])}function _t(e,r){e.state=0;for(let t=0;t<e.sources.length;t+=1){const i=e.sources[t];if(i.sources){const o=i.state;o===_e?i!==r&&(!i.updatedAt||i.updatedAt<It)&&Tt(i):o===Rt&&_t(i,r)}}}function tr(e){for(let r=0;r<e.observers.length;r+=1){const t=e.observers[r];t.state||(t.state=Rt,t.pure?ee.push(t):be.push(t),t.observers&&tr(t))}}function Et(e){let r;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),i=e.sourceSlots.pop(),o=t.observers;if(o&&o.length){const n=o.pop(),a=t.observerSlots.pop();i<o.length&&(n.sourceSlots[a]=i,o[i]=n,t.observerSlots[i]=a)}}if(e.owned){for(r=e.owned.length-1;r>=0;r--)Et(e.owned[r]);e.owned=null}if(e.cleanups){for(r=e.cleanups.length-1;r>=0;r--)e.cleanups[r]();e.cleanups=null}e.state=0}function ks(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function nr(e,r=re){throw ks(e)}function $e(e,r){return Ye(()=>e(r||{}))}const Rs=e=>`Stale read from <${e}>.`;function rr(e){const r=e.keyed,t=Qn(()=>e.when,void 0,{equals:(i,o)=>r?i===o:!i==!o});return Qn(()=>{const i=t();if(i){const o=e.children;return typeof o=="function"&&o.length>0?Ye(()=>o(r?i:()=>{if(!Ye(t))throw Rs("Show");return e.when})):o}return e.fallback},void 0,void 0)}function Is(e,r,t){let i=t.length,o=r.length,n=i,a=0,u=0,c=r[o-1].nextSibling,s=null;for(;a<o||u<n;){if(r[a]===t[u]){a++,u++;continue}for(;r[o-1]===t[n-1];)o--,n--;if(o===a){const l=n<i?u?t[u-1].nextSibling:t[n-u]:c;for(;u<n;)e.insertBefore(t[u++],l)}else if(n===u)for(;a<o;)(!s||!s.has(r[a]))&&r[a].remove(),a++;else if(r[a]===t[n-1]&&t[u]===r[o-1]){const l=r[--o].nextSibling;e.insertBefore(t[u++],r[a++].nextSibling),e.insertBefore(t[--n],l),r[o]=t[n]}else{if(!s){s=new Map;let d=u;for(;d<n;)s.set(t[d],d++)}const l=s.get(r[a]);if(l!=null)if(u<l&&l<n){let d=a,b=1,f;for(;++d<o&&d<n&&!((f=s.get(r[d]))==null||f!==l+b);)b++;if(b>l-u){const k=r[a];for(;u<l;)e.insertBefore(t[u++],k)}else e.replaceChild(t[u++],r[a++])}else a++;else r[a++].remove()}}}const sr="_$DX_DELEGATE";function tt(e,r,t){let i;const o=()=>{const a=document.createElement("template");return a.innerHTML=e,a.content.firstChild},n=()=>(i||(i=o())).cloneNode(!0);return n.cloneNode=n,n}function ir(e,r=window.document){const t=r[sr]||(r[sr]=new Set);for(let i=0,o=e.length;i<o;i++){const n=e[i];t.has(n)||(t.add(n),r.addEventListener(n,Ss))}}function Ct(e,r,t,i){if(t!==void 0&&!i&&(i=[]),typeof r!="function")return At(e,r,i,t);fn(o=>At(e,r(),o,t),i)}function Ss(e){const r=`$$${e.type}`;let t=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==t&&Object.defineProperty(e,"target",{configurable:!0,value:t}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}});t;){const i=t[r];if(i&&!t.disabled){const o=t[`${r}Data`];if(o!==void 0?i.call(t,o,e):i.call(t,e),e.cancelBubble)return}t=t._$host||t.parentNode||t.host}}function At(e,r,t,i,o){for(;typeof t=="function";)t=t();if(r===t)return t;const n=typeof r,a=i!==void 0;if(e=a&&t[0]&&t[0].parentNode||e,n==="string"||n==="number")if(n==="number"&&(r=r.toString()),a){let u=t[0];u&&u.nodeType===3?u.data!==r&&(u.data=r):u=document.createTextNode(r),t=Ve(e,t,i,u)}else t!==""&&typeof t=="string"?t=e.firstChild.data=r:t=e.textContent=r;else if(r==null||n==="boolean")t=Ve(e,t,i);else{if(n==="function")return fn(()=>{let u=r();for(;typeof u=="function";)u=u();t=At(e,u,t,i)}),()=>t;if(Array.isArray(r)){const u=[],c=t&&Array.isArray(t);if(gn(u,r,t,o))return fn(()=>t=At(e,u,t,i,!0)),()=>t;if(u.length===0){if(t=Ve(e,t,i),a)return t}else c?t.length===0?or(e,u,i):Is(e,t,u):(t&&Ve(e),or(e,u));t=u}else if(r.nodeType){if(Array.isArray(t)){if(a)return t=Ve(e,t,i,r);Ve(e,t,null,r)}else t==null||t===""||!e.firstChild?e.appendChild(r):e.replaceChild(r,e.firstChild);t=r}}return t}function gn(e,r,t,i){let o=!1;for(let n=0,a=r.length;n<a;n++){let u=r[n],c=t&&t[e.length],s;if(!(u==null||u===!0||u===!1))if((s=typeof u)=="object"&&u.nodeType)e.push(u);else if(Array.isArray(u))o=gn(e,u,c)||o;else if(s==="function")if(i){for(;typeof u=="function";)u=u();o=gn(e,Array.isArray(u)?u:[u],Array.isArray(c)?c:[c])||o}else e.push(u),o=!0;else{const l=String(u);c&&c.nodeType===3&&c.data===l?e.push(c):e.push(document.createTextNode(l))}}return o}function or(e,r,t=null){for(let i=0,o=r.length;i<o;i++)e.insertBefore(r[i],t)}function Ve(e,r,t,i){if(t===void 0)return e.textContent="";const o=i||document.createTextNode("");if(r.length){let n=!1;for(let a=r.length-1;a>=0;a--){const u=r[a];if(o!==u){const c=u.parentNode===e;!n&&!a?c?e.replaceChild(o,u):e.insertBefore(o,t):c&&u.remove()}else n=!0}}else e.insertBefore(o,t);return[o]}function Ts(e){return Object.keys(e).reduce((t,i)=>{const o=e[i];return t[i]=Object.assign({},o),lr(o.value)&&!Ps(o.value)&&!Array.isArray(o.value)&&(t[i].value=Object.assign({},o.value)),Array.isArray(o.value)&&(t[i].value=o.value.slice(0)),t},{})}function _s(e){return e?Object.keys(e).reduce((t,i)=>{const o=e[i];return t[i]=lr(o)&&"value"in o?o:{value:o},t[i].attribute||(t[i].attribute=As(i)),t[i].parse="parse"in t[i]?t[i].parse:typeof t[i].value!="string",t},{}):{}}function Es(e){return Object.keys(e).reduce((t,i)=>(t[i]=e[i].value,t),{})}function Cs(e,r){const t=Ts(r);return Object.keys(r).forEach(o=>{const n=t[o],a=e.getAttribute(n.attribute),u=e[o];a&&(n.value=n.parse?ar(a):a),u!=null&&(n.value=Array.isArray(u)?u.slice(0):u),n.reflect&&ur(e,n.attribute,n.value),Object.defineProperty(e,o,{get(){return n.value},set(c){const s=n.value;n.value=c,n.reflect&&ur(this,n.attribute,n.value);for(let l=0,d=this.__propertyChangedCallbacks.length;l<d;l++)this.__propertyChangedCallbacks[l](o,c,s)},enumerable:!0,configurable:!0})}),t}function ar(e){if(e)try{return JSON.parse(e)}catch{return e}}function ur(e,r,t){if(t==null||t===!1)return e.removeAttribute(r);let i=JSON.stringify(t);e.__updating[r]=!0,i==="true"&&(i=""),e.setAttribute(r,i),Promise.resolve().then(()=>delete e.__updating[r])}function As(e){return e.replace(/\.?([A-Z]+)/g,(r,t)=>"-"+t.toLowerCase()).replace("_","-").replace(/^-/,"")}function lr(e){return e!=null&&(typeof e=="object"||typeof e=="function")}function Ps(e){return Object.prototype.toString.call(e)==="[object Function]"}function Os(e){return typeof e=="function"&&e.toString().indexOf("class")===0}let nt;function cr(){Object.defineProperty(nt,"renderRoot",{value:nt})}function Ds(e,r){const t=Object.keys(r);return class extends e{static get observedAttributes(){return t.map(o=>r[o].attribute)}constructor(){super(),this.__initialized=!1,this.__released=!1,this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props={}}connectedCallback(){if(this.__initialized)return;this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props=Cs(this,r);const o=Es(this.props),n=this.Component,a=nt;try{nt=this,this.__initialized=!0,Os(n)?new n(o,{element:this}):n(o,{element:this})}finally{nt=a}}async disconnectedCallback(){if(await Promise.resolve(),this.isConnected)return;this.__propertyChangedCallbacks.length=0;let o=null;for(;o=this.__releaseCallbacks.pop();)o(this);delete this.__initialized,this.__released=!0}attributeChangedCallback(o,n,a){if(this.__initialized&&!this.__updating[o]&&(o=this.lookupProp(o),o in r)){if(a==null&&!this[o])return;this[o]=r[o].parse?ar(a):a}}lookupProp(o){if(r)return t.find(n=>o===n||o===r[n].attribute)}get renderRoot(){return this.shadowRoot||this.attachShadow({mode:"open"})}addReleaseCallback(o){this.__releaseCallbacks.push(o)}addPropertyChangedCallback(o){this.__propertyChangedCallbacks.push(o)}}}function Ms(e,r={},t={}){const{BaseElement:i=HTMLElement,extension:o}=t;return n=>{if(!e)throw new Error("tag is required to register a Component");let a=customElements.get(e);return a?(a.prototype.Component=n,a):(a=Ds(i,_s(r)),a.prototype.Component=n,a.prototype.registeredTag=e,customElements.define(e,a,o),a)}}function xs(e){const r=Object.keys(e),t={};for(let i=0;i<r.length;i++){const[o,n]=St(e[r[i]]);Object.defineProperty(t,r[i],{get:o,set(a){n(()=>a)}})}return t}function Hs(e){if(e.assignedSlot&&e.assignedSlot._$owner)return e.assignedSlot._$owner;let r=e.parentNode;for(;r&&!r._$owner&&!(r.assignedSlot&&r.assignedSlot._$owner);)r=r.parentNode;return r&&r.assignedSlot?r.assignedSlot._$owner:e._$owner}function Fs(e){return(r,t)=>{const{element:i}=t;return ms(o=>{const n=xs(r);i.addPropertyChangedCallback((u,c)=>n[u]=c),i.addReleaseCallback(()=>{i.renderRoot.textContent="",o()});const a=e(n,t);return Ct(i.renderRoot,a)},Hs(i))}}function dr(e,r,t){return arguments.length===2&&(t=r,r={}),Ms(e,r)(Fs(t))}var Ls=tt("<div class=wrapper><header>Hacking with SuperTokens</header><main></main><footer>Copyright or something, IDK.");function fr(e){return(()=>{var r=Ls(),t=r.firstChild,i=t.nextSibling;return Ct(i,()=>e.children),r})()}var p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hr={},gr={},G={},pn={},vr={},ie={},Pt={},he=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},ge=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.defaultWindowHandlerImplementation=void 0;function V(){if(typeof window>"u")throw Error("If you are using this package with server-side rendering, please make sure that you are checking if the window object is defined.");return window}var Us={key:function(e){return he(this,void 0,void 0,function(){return ge(this,function(r){return[2,V().localStorage.key(e)]})})},clear:function(){return he(this,void 0,void 0,function(){return ge(this,function(e){return[2,V().localStorage.clear()]})})},getItem:function(e){return he(this,void 0,void 0,function(){return ge(this,function(r){return[2,V().localStorage.getItem(e)]})})},removeItem:function(e){return he(this,void 0,void 0,function(){return ge(this,function(r){return[2,V().localStorage.removeItem(e)]})})},setItem:function(e,r){return he(this,void 0,void 0,function(){return ge(this,function(t){return[2,V().localStorage.setItem(e,r)]})})},keySync:function(e){return V().localStorage.key(e)},clearSync:function(){return V().localStorage.clear()},getItemSync:function(e){return V().localStorage.getItem(e)},removeItemSync:function(e){return V().localStorage.removeItem(e)},setItemSync:function(e,r){return V().localStorage.setItem(e,r)}},Ns={key:function(e){return he(this,void 0,void 0,function(){return ge(this,function(r){return[2,V().sessionStorage.key(e)]})})},clear:function(){return he(this,void 0,void 0,function(){return ge(this,function(e){return[2,V().sessionStorage.clear()]})})},getItem:function(e){return he(this,void 0,void 0,function(){return ge(this,function(r){return[2,V().sessionStorage.getItem(e)]})})},removeItem:function(e){return he(this,void 0,void 0,function(){return ge(this,function(r){return[2,V().sessionStorage.removeItem(e)]})})},setItem:function(e,r){return he(this,void 0,void 0,function(){return ge(this,function(t){return[2,V().sessionStorage.setItem(e,r)]})})},keySync:function(e){return V().sessionStorage.key(e)},clearSync:function(){return V().sessionStorage.clear()},getItemSync:function(e){return V().sessionStorage.getItem(e)},removeItemSync:function(e){return V().sessionStorage.removeItem(e)},setItemSync:function(e,r){return V().sessionStorage.setItem(e,r)}};Pt.defaultWindowHandlerImplementation={history:{replaceState:function(e,r,t){return V().history.replaceState(e,r,t)},getState:function(){return V().history.state}},location:{getHref:function(){return V().location.href},setHref:function(e){V().location.href=e},getSearch:function(){return V().location.search},getHash:function(){return V().location.hash},getPathName:function(){return V().location.pathname},assign:function(e){V().location.assign(e)},getHostName:function(){return V().location.hostname},getHost:function(){return V().location.host},getOrigin:function(){return V().location.origin}},getDocument:function(){return V().document},getWindowUnsafe:function(){return V().window},localStorage:Us,sessionStorage:Ns},Object.defineProperty(ie,"__esModule",{value:!0}),ie.WindowHandlerReference=void 0;var qs=Pt,pr=function(){function e(r){var t=function(i){return i};r!==void 0&&(t=r),this.windowHandler=t(qs.defaultWindowHandlerImplementation)}return e.init=function(r){e.instance===void 0&&(e.instance=new e(r))},e.getReferenceOrThrow=function(){if(e.instance===void 0)throw new Error("SuperTokensWindowHandler must be initialized before calling this method.");return e.instance},e}();ie.WindowHandlerReference=pr,ie.default=pr,function(e){function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}e.__esModule=!0,r(ie)}(vr),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WindowHandlerReference=void 0;var r=vr;Object.defineProperty(e,"WindowHandlerReference",{enumerable:!0,get:function(){return r.WindowHandlerReference}})}(pn);var Be={};Object.defineProperty(Be,"__esModule",{value:!0}),Be.SSR_ERROR=Be.DEFAULT_API_BASE_PATH=void 0,Be.DEFAULT_API_BASE_PATH="/auth",Be.SSR_ERROR=`
If you are trying to use this method doing server-side-rendering, please make sure you move this method inside a componentDidMount method or useEffect hook.`;var mn={};Object.defineProperty(mn,"__esModule",{value:!0});var js=function(){function e(r){var t=this;this.getAsStringDangerous=function(){return t.value},this.value=mr(r)}return e}();mn.default=js;function mr(e,r){r===void 0&&(r=!1);function t(o){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(o)}e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("Error converting to proper URL");var i=new URL(e);return r?i.hostname.startsWith("localhost")||t(i.hostname)?e="http://"+i.host:e="https://"+i.host:e=i.protocol+"//"+i.host,e}catch{}if(e.startsWith("/"))throw new Error("Please provide a valid domain name");if(e.indexOf(".")===0&&(e=e.substr(1)),(e.indexOf(".")!==-1||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://")){e="https://"+e;try{return new URL(e),mr(e,!0)}catch{}}throw new Error("Please provide a valid domain name")}var Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});var $s=function(){function e(r){var t=this;this.startsWith=function(i){return t.value.startsWith(i.value)},this.appendPath=function(i){return new e(t.value+i.value)},this.getAsStringDangerous=function(){return t.value},this.value=wn(r)}return e}();Ot.default=$s;function wn(e){e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("Error converting to proper URL");var r=new URL(e);return e=r.pathname,e.charAt(e.length-1)==="/"?e.substr(0,e.length-1):e}catch{}if((Vs(e)||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://"))return e="http://"+e,wn(e);e.charAt(0)!=="/"&&(e="/"+e);try{return new URL("http://example.com"+e),wn("http://example.com"+e)}catch{throw new Error("Please provide a valid URL path")}}function Vs(e){if(e.indexOf(".")===-1||e.startsWith("/"))return!1;try{var r=new URL(e);return r.hostname.indexOf(".")!==-1}catch{}try{var r=new URL("http://"+e);return r.hostname.indexOf(".")!==-1}catch{}return!1}var wr={},Dt={},te={},rt={};Object.defineProperty(rt,"__esModule",{value:!0}),rt.isAnIpAddress=void 0;function yr(e){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}rt.isAnIpAddress=yr;var Bs=function(){function e(r){var t=this;this.getAsStringDangerous=function(){return t.value},this.value=br(r)}return e}();rt.default=Bs;function br(e,r){r===void 0&&(r=!1),e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("converting to proper URL");var t=new URL(e);return r?t.hostname.startsWith("localhost")||yr(t.hostname)?e="http://"+t.host:e="https://"+t.host:e=t.protocol+"//"+t.host,e}catch{}if(e.startsWith("/"))throw new Error("Please provide a valid domain name");if(e.indexOf(".")===0&&(e=e.substr(1)),(e.indexOf(".")!==-1||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://")){e="https://"+e;try{return new URL(e),br(e,!0)}catch{}}throw new Error("Please provide a valid domain name")}var yn={};Object.defineProperty(yn,"__esModule",{value:!0});var Gs=function(){function e(r){var t=this;this.startsWith=function(i){return t.value.startsWith(i.value)},this.appendPath=function(i){return new e(t.value+i.value)},this.getAsStringDangerous=function(){return t.value},this.value=bn(r)}return e}();yn.default=Gs;function bn(e){e=e.trim();try{if(!e.startsWith("http://")&&!e.startsWith("https://"))throw new Error("converting to proper URL");var r=new URL(e);return e=r.pathname,e.charAt(e.length-1)==="/"?e.substr(0,e.length-1):e}catch{}if((Ws(e)||e.startsWith("localhost"))&&!e.startsWith("http://")&&!e.startsWith("https://"))return e="http://"+e,bn(e);e.charAt(0)!=="/"&&(e="/"+e);try{return new URL("http://example.com"+e),bn("http://example.com"+e)}catch{throw new Error("Please provide a valid URL path")}}function Ws(e){if(e.indexOf(".")===-1||e.startsWith("/"))return!1;try{var r=new URL(e);return r.hostname.indexOf(".")!==-1}catch{}try{var r=new URL("http://"+e);return r.hostname.indexOf(".")!==-1}catch{}return!1}var kn=p&&p.__assign||function(){return kn=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},kn.apply(this,arguments)},kr=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},Rr=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(te,"__esModule",{value:!0}),te.matchesDomainOrSubdomain=te.getNormalisedUserContext=te.validateAndNormaliseInputOrThrowError=te.normaliseSessionScopeOrThrowError=te.normaliseURLPathOrThrowError=te.normaliseURLDomainOrThrowError=void 0;var Ir=rt,Xs=yn,zs=ie;function Sr(e){var r=new Ir.default(e).getAsStringDangerous();return r}te.normaliseURLDomainOrThrowError=Sr;function Rn(e){return new Xs.default(e).getAsStringDangerous()}te.normaliseURLPathOrThrowError=Rn;function In(e){function r(i){i=i.trim().toLowerCase(),i.startsWith(".")&&(i=i.substr(1)),!i.startsWith("http://")&&!i.startsWith("https://")&&(i="http://"+i);try{var o=new URL(i);return i=o.hostname,i}catch{throw new Error("Please provide a valid sessionScope")}}var t=r(e);return t==="localhost"||(0,Ir.isAnIpAddress)(t)?t:e.startsWith(".")?"."+t:t}te.normaliseSessionScopeOrThrowError=In;function Js(e){var r=this,t=Sr(e.apiDomain),i=Rn("/auth");e.apiBasePath!==void 0&&(i=Rn(e.apiBasePath));var o=zs.default.getReferenceOrThrow().windowHandler.location.getHostName(),n=In(e!==void 0&&e.sessionTokenFrontendDomain!==void 0?e.sessionTokenFrontendDomain:o),a=401;e.sessionExpiredStatusCode!==void 0&&(a=e.sessionExpiredStatusCode);var u=403;if(e.invalidClaimStatusCode!==void 0&&(u=e.invalidClaimStatusCode),a===u)throw new Error("sessionExpiredStatusCode and invalidClaimStatusCode cannot be the same.");var c=!0;e.autoAddCredentials!==void 0&&(c=e.autoAddCredentials);var s=!1;e.isInIframe!==void 0&&(s=e.isInIframe);var l=void 0;e.sessionTokenBackendDomain!==void 0&&(l=In(e.sessionTokenBackendDomain));var d=10;if(e.maxRetryAttemptsForSessionRefresh!==void 0){if(e.maxRetryAttemptsForSessionRefresh<0)throw new Error("maxRetryAttemptsForSessionRefresh must be greater than or equal to 0.");d=e.maxRetryAttemptsForSessionRefresh}var b=function(U){return kr(r,void 0,void 0,function(){return Rr(this,function(M){return[2,{url:U.url,requestInit:U.requestInit}]})})};e.preAPIHook!==void 0&&(b=e.preAPIHook);var f=function(){return kr(r,void 0,void 0,function(){return Rr(this,function(U){return[2]})})};e.postAPIHook!==void 0&&(f=e.postAPIHook);var k=function(){};e.onHandleEvent!==void 0&&(k=e.onHandleEvent);var H=kn({functions:function(U){return U}},e.override);return{apiDomain:t,apiBasePath:i,sessionTokenFrontendDomain:n,sessionExpiredStatusCode:a,invalidClaimStatusCode:u,autoAddCredentials:c,isInIframe:s,tokenTransferMethod:e.tokenTransferMethod!==void 0?e.tokenTransferMethod:"cookie",sessionTokenBackendDomain:l,maxRetryAttemptsForSessionRefresh:d,preAPIHook:b,postAPIHook:f,onHandleEvent:k,override:H}}te.validateAndNormaliseInputOrThrowError=Js;function Ks(e){return e===void 0?{}:e}te.getNormalisedUserContext=Ks;function Qs(e,r){for(var t=e.split("."),i=0;i<t.length;i++){var o=t.slice(i).join(".");if(o===r||".".concat(o)===r)return!0}return!1}te.matchesDomainOrSubdomain=Qs;var Ge={},Mt={};(function(e){var r=p&&p.__awaiter||function(o,n,a,u){function c(s){return s instanceof a?s:new a(function(l){l(s)})}return new(a||(a=Promise))(function(s,l){function d(k){try{f(u.next(k))}catch(H){l(H)}}function b(k){try{f(u.throw(k))}catch(H){l(H)}}function f(k){k.done?s(k.value):c(k.value).then(d,b)}f((u=u.apply(o,n||[])).next())})},t=p&&p.__generator||function(o,n){var a={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},u,c,s,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(f){return function(k){return b([f,k])}}function b(f){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,c&&(s=f[0]&2?c.return:f[0]?c.throw||((s=c.return)&&s.call(c),0):c.next)&&!(s=s.call(c,f[1])).done)return s;switch(c=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return a.label++,{value:f[1],done:!1};case 5:a.label++,c=f[1],f=[0];continue;case 7:f=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){a=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){a.label=f[1];break}if(f[0]===6&&a.label<s[1]){a.label=s[1],s=f;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(f);break}s[2]&&a.ops.pop(),a.trys.pop();continue}f=n.call(o,a)}catch(k){f=[6,k],c=0}finally{u=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ProcessState=e.PROCESS_STATE=void 0,function(o){o[o.CALLING_INTERCEPTION_REQUEST=0]="CALLING_INTERCEPTION_REQUEST",o[o.CALLING_INTERCEPTION_RESPONSE=1]="CALLING_INTERCEPTION_RESPONSE"}(e.PROCESS_STATE||(e.PROCESS_STATE={}));var i=function(){function o(){var n=this;this.history=[],this.addState=function(a){try{process!==void 0&&process.env!==void 0&&process.env.TEST_MODE==="testing"&&n.history.push(a)}catch{}},this.getEventByLastEventByName=function(a){for(var u=n.history.length-1;u>=0;u--)if(n.history[u]==a)return n.history[u]},this.reset=function(){n.history=[]},this.waitForEvent=function(a,u){return u===void 0&&(u=7e3),r(n,void 0,void 0,function(){var c,s=this;return t(this,function(l){return c=Date.now(),[2,new Promise(function(d){var b=s;function f(){var k=b.getEventByLastEventByName(a);k===void 0?Date.now()-c>u?d(void 0):setTimeout(f,1e3):d(k)}f()})]})})}}return o.getInstance=function(){return o.instance==null&&(o.instance=new o),o.instance},o}();e.ProcessState=i})(Mt);var Ee={};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.supported_fdi=Ee.package_version=void 0,Ee.package_version="20.1.1",Ee.supported_fdi=["1.16","1.17","1.18","1.19","2.0","3.0"];var Oe={},xt={},Tr=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},_r=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(xt,"__esModule",{value:!0}),xt.defaultCookieHandlerImplementation=void 0;var Er=ie;xt.defaultCookieHandlerImplementation={getCookie:function(){return Tr(this,void 0,void 0,function(){return _r(this,function(e){return[2,Er.default.getReferenceOrThrow().windowHandler.getWindowUnsafe().document.cookie]})})},setCookie:function(e){return Tr(this,void 0,void 0,function(){return _r(this,function(r){return Er.default.getReferenceOrThrow().windowHandler.getWindowUnsafe().document.cookie=e,[2]})})}},Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.CookieHandlerReference=void 0;var Ys=xt,Cr=function(){function e(r){var t=function(i){return i};r!==void 0&&(t=r),this.cookieHandler=t(Ys.defaultCookieHandlerImplementation)}return e.init=function(r){e.instance===void 0&&(e.instance=new e(r))},e.getReferenceOrThrow=function(){if(e.instance===void 0)throw new Error("SuperTokensCookieHandler must be initialized before calling this method.");return e.instance},e}();Oe.CookieHandlerReference=Cr,Oe.default=Cr;var De={},Sn={},Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});var Zs=function(){function e(){var r=this;this.locked=new Map,this.addToLocked=function(t,i){var o=r.locked.get(t);o===void 0?i===void 0?r.locked.set(t,[]):r.locked.set(t,[i]):i!==void 0&&(o.unshift(i),r.locked.set(t,o))},this.isLocked=function(t){return r.locked.has(t)},this.lock=function(t){return new Promise(function(i,o){r.isLocked(t)?r.addToLocked(t,i):(r.addToLocked(t),i())})},this.unlock=function(t){var i=r.locked.get(t);if(i===void 0||i.length===0){r.locked.delete(t);return}var o=i.pop();r.locked.set(t,i),o!==void 0&&setTimeout(o,0)}}return e.getInstance=function(){return e.instance===void 0&&(e.instance=new e),e.instance},e}();function ei(){return Zs.getInstance()}Tn.default=ei;var ue=p&&p.__awaiter||function(e,r,t,i){return new(t||(t=Promise))(function(o,n){function a(s){try{c(i.next(s))}catch(l){n(l)}}function u(s){try{c(i.throw(s))}catch(l){n(l)}}function c(s){s.done?o(s.value):new t(function(l){l(s.value)}).then(a,u)}c((i=i.apply(e,r||[])).next())})},le=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},st=p;Object.defineProperty(Sn,"__esModule",{value:!0});var We=Tn,_n="browser-tabs-lock-key",Ht={key:function(e){return ue(st,void 0,void 0,function(){return le(this,function(r){throw new Error("Unsupported")})})},getItem:function(e){return ue(st,void 0,void 0,function(){return le(this,function(r){throw new Error("Unsupported")})})},clear:function(){return ue(st,void 0,void 0,function(){return le(this,function(e){return[2,window.localStorage.clear()]})})},removeItem:function(e){return ue(st,void 0,void 0,function(){return le(this,function(r){throw new Error("Unsupported")})})},setItem:function(e,r){return ue(st,void 0,void 0,function(){return le(this,function(t){throw new Error("Unsupported")})})},keySync:function(e){return window.localStorage.key(e)},getItemSync:function(e){return window.localStorage.getItem(e)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(e){return window.localStorage.removeItem(e)},setItemSync:function(e,r){return window.localStorage.setItem(e,r)}};function En(e){return new Promise(function(r){return setTimeout(r,e)})}function Cn(e){for(var r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="",i=0;i<e;i++){var o=Math.floor(Math.random()*r.length);t+=r[o]}return t}function ti(){return Date.now().toString()+Cn(15)}var ni=function(){function e(r){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=ti(),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=r,e.waiters===void 0&&(e.waiters=[])}return e.prototype.acquireLock=function(r,t){return t===void 0&&(t=5e3),ue(this,void 0,void 0,function(){var i,o,n,a,u,c,s,l;return le(this,function(d){switch(d.label){case 0:i=Date.now()+Cn(4),o=Date.now()+t,n=_n+"-"+r,a=this.storageHandler===void 0?Ht:this.storageHandler,d.label=1;case 1:return Date.now()<o?[4,En(30)]:[3,8];case 2:return d.sent(),u=a.getItemSync(n),u!==null?[3,5]:(c=this.id+"-"+r+"-"+i,[4,En(Math.floor(Math.random()*25))]);case 3:return d.sent(),a.setItemSync(n,JSON.stringify({id:this.id,iat:i,timeoutKey:c,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,En(30)];case 4:return d.sent(),s=a.getItemSync(n),s!==null&&(l=JSON.parse(s),l.id===this.id&&l.iat===i)?(this.acquiredIatSet.add(i),this.refreshLockWhileAcquired(n,i),[2,!0]):[3,7];case 5:return e.lockCorrector(this.storageHandler===void 0?Ht:this.storageHandler),[4,this.waitForSomethingToChange(o)];case 6:d.sent(),d.label=7;case 7:return i=Date.now()+Cn(4),[3,1];case 8:return[2,!1]}})})},e.prototype.refreshLockWhileAcquired=function(r,t){return ue(this,void 0,void 0,function(){var i=this;return le(this,function(o){return setTimeout(function(){return ue(i,void 0,void 0,function(){var n,a,u;return le(this,function(c){switch(c.label){case 0:return[4,We.default().lock(t)];case 1:if(c.sent(),!this.acquiredIatSet.has(t))return We.default().unlock(t),[2];if(n=this.storageHandler===void 0?Ht:this.storageHandler,a=n.getItemSync(r),a!==null)u=JSON.parse(a),u.timeRefreshed=Date.now(),n.setItemSync(r,JSON.stringify(u)),We.default().unlock(t);else return We.default().unlock(t),[2];return this.refreshLockWhileAcquired(r,t),[2]}})})},1e3),[2]})})},e.prototype.waitForSomethingToChange=function(r){return ue(this,void 0,void 0,function(){return le(this,function(t){switch(t.label){case 0:return[4,new Promise(function(i){var o=!1,n=Date.now(),a=50,u=!1;function c(){if(u||(window.removeEventListener("storage",c),e.removeFromWaiting(c),clearTimeout(s),u=!0),!o){o=!0;var l=a-(Date.now()-n);l>0?setTimeout(i,l):i(null)}}window.addEventListener("storage",c),e.addToWaiting(c);var s=setTimeout(c,Math.max(0,r-Date.now()))})];case 1:return t.sent(),[2]}})})},e.addToWaiting=function(r){this.removeFromWaiting(r),e.waiters!==void 0&&e.waiters.push(r)},e.removeFromWaiting=function(r){e.waiters!==void 0&&(e.waiters=e.waiters.filter(function(t){return t!==r}))},e.notifyWaiters=function(){if(e.waiters!==void 0){var r=e.waiters.slice();r.forEach(function(t){return t()})}},e.prototype.releaseLock=function(r){return ue(this,void 0,void 0,function(){return le(this,function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(r)];case 1:return[2,t.sent()]}})})},e.prototype.releaseLock__private__=function(r){return ue(this,void 0,void 0,function(){var t,i,o,n;return le(this,function(a){switch(a.label){case 0:return t=this.storageHandler===void 0?Ht:this.storageHandler,i=_n+"-"+r,o=t.getItemSync(i),o===null?[2]:(n=JSON.parse(o),n.id!==this.id?[3,2]:[4,We.default().lock(n.iat)]);case 1:a.sent(),this.acquiredIatSet.delete(n.iat),t.removeItemSync(i),We.default().unlock(n.iat),e.notifyWaiters(),a.label=2;case 2:return[2]}})})},e.lockCorrector=function(r){for(var t=Date.now()-5e3,i=r,o=[],n=0;;){var a=i.keySync(n);if(a===null)break;o.push(a),n++}for(var u=!1,c=0;c<o.length;c++){var s=o[c];if(s.includes(_n)){var l=i.getItemSync(s);if(l!==null){var d=JSON.parse(l);(d.timeRefreshed===void 0&&d.timeAcquired<t||d.timeRefreshed!==void 0&&d.timeRefreshed<t)&&(i.removeItemSync(s),u=!0)}}}u&&e.notifyWaiters()},e.waiters=void 0,e}();Sn.default=ni,Object.defineProperty(De,"__esModule",{value:!0}),De.LockFactoryReference=void 0;var ri=Sn,si=function(e){return function(){return Promise.resolve(new ri.default(e))}},Ar=function(){function e(r){this.lockFactory=r}return e.init=function(r,t){this.instance===void 0&&(this.instance=new e(r??si(t)))},e.getReferenceOrThrow=function(){if(e.instance===void 0)throw new Error("SuperTokensLockReference must be initialized before calling this method.");return e.instance},e}();De.LockFactoryReference=Ar,De.default=Ar;var oe={};Object.defineProperty(oe,"__esModule",{value:!0}),oe.logDebugMessage=oe.disableLogging=oe.enableLogging=void 0;var ii=Ee,oi="com.supertokens",An=!1;function ai(){An=!0}oe.enableLogging=ai;function ui(){An=!1}oe.disableLogging=ui;function li(e){An&&console.log("".concat(oi,' {t: "').concat(new Date().toISOString(),'", message: "').concat(e,'", supertokens-website-ver: "').concat(ii.package_version,'"}'))}oe.logDebugMessage=li;var ve={},Ft={};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.DateProvider=void 0;var Pr=ie,ci=function(){function e(){this.clockSkewInMillis=0,this.thresholdInSeconds=7}return e.init=function(){if(e.instance===void 0){e.instance=new e;var r=Pr.default.getReferenceOrThrow().windowHandler.localStorage,t=r.getItemSync(e.CLOCK_SKEW_KEY),i=t!==null?parseInt(t,10):0;e.instance.setClientClockSkewInMillis(i)}},e.getReferenceOrThrow=function(){if(e.instance===void 0)throw new Error("DateProvider must be initialized before calling this method.");return e.instance},e.prototype.getThresholdInSeconds=function(){return this.thresholdInSeconds},e.prototype.setThresholdInSeconds=function(r){this.thresholdInSeconds=r},e.prototype.setClientClockSkewInMillis=function(r){this.clockSkewInMillis=Math.abs(r)>=this.thresholdInSeconds*1e3?r:0;var t=Pr.default.getReferenceOrThrow().windowHandler.localStorage;t.setItemSync(e.CLOCK_SKEW_KEY,String(r))},e.prototype.getClientClockSkewInMillis=function(){return this.clockSkewInMillis},e.prototype.now=function(){return Date.now()+this.getClientClockSkewInMillis()},e.CLOCK_SKEW_KEY="__st_clockSkewInMillis",e}();Ft.DateProvider=ci,Object.defineProperty(ve,"__esModule",{value:!0}),ve.DateProviderReference=void 0;var Or=Ft,Dr=function(){function e(r){r!==void 0?this.dateProvider=r():(Or.DateProvider.init(),this.dateProvider=Or.DateProvider.getReferenceOrThrow())}return e.init=function(r){e.instance===void 0&&(e.instance=new e(r))},e.getReferenceOrThrow=function(){if(e.instance===void 0)throw new Error("SuperTokensDateProvider must be initialized before calling this method.");return e.instance},e}();ve.DateProviderReference=Dr,ve.default=Dr,function(e){var r=p&&p.__assign||function(){return r=Object.assign||function(h){for(var y,w=1,R=arguments.length;w<R;w++){y=arguments[w];for(var I in y)Object.prototype.hasOwnProperty.call(y,I)&&(h[I]=y[I])}return h},r.apply(this,arguments)},t=p&&p.__awaiter||function(h,y,w,R){function I(C){return C instanceof w?C:new w(function(j){j(C)})}return new(w||(w=Promise))(function(C,j){function X(J){try{q(R.next(J))}catch(B){j(B)}}function fe(J){try{q(R.throw(J))}catch(B){j(B)}}function q(J){J.done?C(J.value):I(J.value).then(X,fe)}q((R=R.apply(h,y||[])).next())})},i=p&&p.__generator||function(h,y){var w={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},R,I,C,j;return j={next:X(0),throw:X(1),return:X(2)},typeof Symbol=="function"&&(j[Symbol.iterator]=function(){return this}),j;function X(q){return function(J){return fe([q,J])}}function fe(q){if(R)throw new TypeError("Generator is already executing.");for(;w;)try{if(R=1,I&&(C=q[0]&2?I.return:q[0]?I.throw||((C=I.return)&&C.call(I),0):I.next)&&!(C=C.call(I,q[1])).done)return C;switch(I=0,C&&(q=[q[0]&2,C.value]),q[0]){case 0:case 1:C=q;break;case 4:return w.label++,{value:q[1],done:!1};case 5:w.label++,I=q[1],q=[0];continue;case 7:q=w.ops.pop(),w.trys.pop();continue;default:if(C=w.trys,!(C=C.length>0&&C[C.length-1])&&(q[0]===6||q[0]===2)){w=0;continue}if(q[0]===3&&(!C||q[1]>C[0]&&q[1]<C[3])){w.label=q[1];break}if(q[0]===6&&w.label<C[1]){w.label=C[1],C=q;break}if(C&&w.label<C[2]){w.label=C[2],w.ops.push(q);break}C[2]&&w.ops.pop(),w.trys.pop();continue}q=y.call(h,w)}catch(J){q=[6,J],I=0}finally{R=C=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.updateClockSkewUsingFrontToken=e.fireSessionUpdateEventsIfNecessary=e.setFrontToken=e.getFrontToken=e.setAntiCSRF=e.saveLastAccessTokenUpdate=e.getTokenForHeaderAuth=e.setToken=e.getStorageNameForToken=e.getLocalSessionState=e.onInvalidClaimResponse=e.onTokenUpdate=e.onUnauthorisedResponse=e.FrontToken=e.AntiCsrfToken=void 0;var o=Mt,n=Ee,a=Oe,u=ie,c=De,s=oe,l=ve,d=function(){function h(){}return h.getToken=function(y){return t(this,void 0,void 0,function(){var w;return i(this,function(R){switch(R.label){case 0:return(0,s.logDebugMessage)("AntiCsrfToken.getToken: called"),y===void 0?(h.tokenInfo=void 0,(0,s.logDebugMessage)("AntiCsrfToken.getToken: returning undefined"),[2,void 0]):h.tokenInfo!==void 0?[3,2]:[4,Vn()];case 1:return w=R.sent(),w===null?((0,s.logDebugMessage)("AntiCsrfToken.getToken: returning undefined"),[2,void 0]):(h.tokenInfo={antiCsrf:w,associatedAccessTokenUpdate:y},[3,4]);case 2:return h.tokenInfo.associatedAccessTokenUpdate===y?[3,4]:(h.tokenInfo=void 0,[4,h.getToken(y)]);case 3:return[2,R.sent()];case 4:return(0,s.logDebugMessage)("AntiCsrfToken.getToken: returning: "+h.tokenInfo.antiCsrf),[2,h.tokenInfo.antiCsrf]}})})},h.removeToken=function(){return t(this,void 0,void 0,function(){return i(this,function(y){switch(y.label){case 0:return(0,s.logDebugMessage)("AntiCsrfToken.removeToken: called"),h.tokenInfo=void 0,[4,Ne(void 0)];case 1:return y.sent(),[2]}})})},h.setItem=function(y,w){return t(this,void 0,void 0,function(){return i(this,function(R){switch(R.label){case 0:return y===void 0?(h.tokenInfo=void 0,[2]):((0,s.logDebugMessage)("AntiCsrfToken.setItem: called"),[4,Ne(w)]);case 1:return R.sent(),h.tokenInfo={antiCsrf:w,associatedAccessTokenUpdate:y},[2]}})})},h}();e.AntiCsrfToken=d;var b=function(){function h(){}return h.getTokenInfo=function(){return t(this,void 0,void 0,function(){var y,w;return i(this,function(R){switch(R.label){case 0:return(0,s.logDebugMessage)("FrontToken.getTokenInfo: called"),[4,Z()];case 1:return y=R.sent(),y!==null?[3,5]:[4,v(!1)];case 2:return R.sent().status!=="EXISTS"?[3,4]:[4,new Promise(function(I){h.waiters.push(I)})];case 3:return R.sent(),[2,h.getTokenInfo()];case 4:return[2,void 0];case 5:return w=L(y),(0,s.logDebugMessage)("FrontToken.getTokenInfo: returning ate: "+w.ate),(0,s.logDebugMessage)("FrontToken.getTokenInfo: returning uid: "+w.uid),(0,s.logDebugMessage)("FrontToken.getTokenInfo: returning up: "+w.up),[2,w]}})})},h.removeToken=function(){return t(this,void 0,void 0,function(){return i(this,function(y){switch(y.label){case 0:return(0,s.logDebugMessage)("FrontToken.removeToken: called"),[4,we(void 0)];case 1:return y.sent(),[4,P("access","")];case 2:return y.sent(),[4,P("refresh","")];case 3:return y.sent(),h.waiters.forEach(function(w){return w(void 0)}),h.waiters=[],[2]}})})},h.setItem=function(y){return t(this,void 0,void 0,function(){return i(this,function(w){switch(w.label){case 0:return[4,Ue()];case 1:return w.sent(),y==="remove"?[2,h.removeToken()]:((0,s.logDebugMessage)("FrontToken.setItem: called"),[4,we(y)]);case 2:return w.sent(),h.waiters.forEach(function(R){return R(void 0)}),h.waiters=[],[2]}})})},h.doesTokenExists=function(){return t(this,void 0,void 0,function(){var y;return i(this,function(w){switch(w.label){case 0:return[4,Qe()];case 1:return y=w.sent(),[2,y!==null]}})})},h.waiters=[],h}();e.FrontToken=b;var f=function(){function h(){}h.init=function(w,R){(0,s.logDebugMessage)("init: called"),(0,s.logDebugMessage)("init: Input apiBasePath: "+w.apiBasePath),(0,s.logDebugMessage)("init: Input apiDomain: "+w.apiDomain),(0,s.logDebugMessage)("init: Input autoAddCredentials: "+w.autoAddCredentials),(0,s.logDebugMessage)("init: Input sessionTokenBackendDomain: "+w.sessionTokenBackendDomain),(0,s.logDebugMessage)("init: Input isInIframe: "+w.isInIframe),(0,s.logDebugMessage)("init: Input sessionExpiredStatusCode: "+w.sessionExpiredStatusCode),(0,s.logDebugMessage)("init: Input sessionTokenFrontendDomain: "+w.sessionTokenFrontendDomain),(0,s.logDebugMessage)("init: Input tokenTransferMethod: "+w.tokenTransferMethod);var I=u.default.getReferenceOrThrow().windowHandler.getWindowUnsafe();h.env=I===void 0||I.fetch===void 0?p:I,h.refreshTokenUrl=w.apiDomain+w.apiBasePath+"/session/refresh",h.signOutUrl=w.apiDomain+w.apiBasePath+"/signout",h.rid="session",h.config=w,h.env.__supertokensOriginalFetch===void 0&&((0,s.logDebugMessage)("init: __supertokensOriginalFetch is undefined"),h.env.__supertokensOriginalFetch=h.env.fetch.bind(h.env),h.env.__supertokensSessionRecipe=R,h.env.fetch=h.env.__supertokensSessionRecipe.addFetchInterceptorsAndReturnModifiedFetch({originalFetch:h.env.__supertokensOriginalFetch,userContext:{}}),h.env.__supertokensSessionRecipe.addXMLHttpRequestInterceptor({userContext:{}})),h.recipeImpl=h.env.__supertokensSessionRecipe,h.initCalled=!0};var y;return y=h,h.initCalled=!1,h.doRequest=function(w,R,I){return t(void 0,void 0,void 0,function(){var C,j,X,fe,q,J,B,bt,qe,je,Gn,Wn,ye,Xn,ln,gs;return i(y,function(Q){switch(Q.label){case 0:if(!h.initCalled)throw Error("init function not called");(0,s.logDebugMessage)("doRequest: start of fetch interception"),C=!1;try{j=void 0,typeof I=="string"?j=I:typeof I=="object"&&(typeof I.url=="string"?j=I.url:typeof I.href=="string"&&(j=I.href)),C=!h.recipeImpl.shouldDoInterceptionBasedOnUrl(j,h.config.apiDomain,h.config.sessionTokenBackendDomain)}catch(vs){if(vs.message==="Please provide a valid domain name")(0,s.logDebugMessage)("doRequest: Trying shouldDoInterceptionBasedOnUrl with location.origin"),C=!h.recipeImpl.shouldDoInterceptionBasedOnUrl(u.default.getReferenceOrThrow().windowHandler.location.getOrigin(),h.config.apiDomain,h.config.sessionTokenBackendDomain);else throw vs}return(0,s.logDebugMessage)("doRequest: Value of doNotDoInterception: "+C),C?((0,s.logDebugMessage)("doRequest: Returning without interception"),[4,w(R)]):[3,2];case 1:return[2,Q.sent()];case 2:return X=new Headers(R!==void 0&&R.headers!==void 0?R.headers:I.headers),X.has("Authorization")?[4,_("access")]:[3,5];case 3:return fe=Q.sent(),[4,_("refresh")];case 4:q=Q.sent(),fe!==void 0&&q!==void 0&&X.get("Authorization")==="Bearer ".concat(fe)&&((0,s.logDebugMessage)("doRequest: Removing Authorization from user provided headers because it contains our access token"),X.delete("Authorization")),Q.label=5;case 5:(0,s.logDebugMessage)("doRequest: Interception started"),o.ProcessState.getInstance().addState(o.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),Q.label=6;case 6:Q.trys.push([6,,20,25]),J=0,B=void 0,Q.label=7;case 7:return[4,v(!0)];case 8:return bt=Q.sent(),qe=new Headers(X),je=r(r({},R),{headers:qe}),bt.status!=="EXISTS"?[3,10]:[4,d.getToken(bt.lastAccessTokenUpdate)];case 9:Gn=Q.sent(),Gn!==void 0&&((0,s.logDebugMessage)("doRequest: Adding anti-csrf token to request"),qe.set("anti-csrf",Gn)),Q.label=10;case 10:return h.config.autoAddCredentials&&((0,s.logDebugMessage)("doRequest: Adding credentials include"),je===void 0?je={credentials:"include"}:je.credentials===void 0&&(je=r(r({},je),{credentials:"include"}))),qe.has("rid")?(0,s.logDebugMessage)("doRequest: rid header was already there in request"):((0,s.logDebugMessage)("doRequest: Adding rid header: anti-csrf"),qe.set("rid","anti-csrf")),Wn=h.config.tokenTransferMethod,(0,s.logDebugMessage)("doRequest: Adding st-auth-mode header: "+Wn),qe.set("st-auth-mode",Wn),[4,x(qe)];case 11:return Q.sent(),(0,s.logDebugMessage)("doRequest: Making user's http call"),[4,w(je)];case 12:return ye=Q.sent(),(0,s.logDebugMessage)("doRequest: User's http call ended"),[4,me(ye)];case 13:if(Q.sent(),Bn(bt.status==="EXISTS",ye.status,ye.headers.get("front-token")),ye.status!==h.config.sessionExpiredStatusCode)return[3,15];if((0,s.logDebugMessage)("doRequest: Status code is: "+ye.status),J>=h.config.maxRetryAttemptsForSessionRefresh)throw(0,s.logDebugMessage)("doRequest: Maximum session refresh attempts reached. sessionRefreshAttempts: ".concat(J,", maxRetryAttemptsForSessionRefresh: ").concat(h.config.maxRetryAttemptsForSessionRefresh)),Xn="Received a 401 response from ".concat(I,". Attempted to refresh the session and retry the request with the updated session tokens ").concat(h.config.maxRetryAttemptsForSessionRefresh," times, but each attempt resulted in a 401 error. The maximum session refresh limit has been reached. Please investigate your API. To increase the session refresh attempts, update maxRetryAttemptsForSessionRefresh in the config."),console.error(Xn),new Error(Xn);return[4,m(bt)];case 14:return ln=Q.sent(),J++,(0,s.logDebugMessage)("doRequest: sessionRefreshAttempts: "+J),ln.result!=="RETRY"?((0,s.logDebugMessage)("doRequest: Not retrying original request"),B=ln.error!==void 0?ln.error:ye,[3,19]):((0,s.logDebugMessage)("doRequest: Retrying original request"),[3,18]);case 15:return ye.status!==h.config.invalidClaimStatusCode?[3,17]:[4,N(ye)];case 16:Q.sent(),Q.label=17;case 17:return[2,ye];case 18:return[3,7];case 19:return[2,B];case 20:return[4,v(!1)];case 21:return gs=Q.sent(),gs.status!=="NOT_EXISTS"?[3,24]:((0,s.logDebugMessage)("doRequest: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,d.removeToken()]);case 22:return Q.sent(),[4,b.removeToken()];case 23:Q.sent(),Q.label=24;case 24:return[7];case 25:return[2]}})})},h.attemptRefreshingSession=function(){return t(void 0,void 0,void 0,function(){var w,R;return i(y,function(I){switch(I.label){case 0:if(!h.initCalled)throw Error("init function not called");return[4,v(!1)];case 1:return w=I.sent(),[4,m(w)];case 2:if(R=I.sent(),R.result==="API_ERROR")throw R.error;return[2,R.result==="RETRY"]}})})},h}();e.default=f;var k="st-last-access-token-update",H="st-refresh-token",U="st-access-token",M="sAntiCsrf",O="sFrontToken";function m(h){return t(this,void 0,void 0,function(){var y,w,R,I,C,j,X,fe,q,J;return i(this,function(B){switch(B.label){case 0:return[4,c.default.getReferenceOrThrow().lockFactory()];case 1:y=B.sent(),B.label=2;case 2:return(0,s.logDebugMessage)("onUnauthorisedResponse: trying to acquire lock"),[4,y.acquireLock("REFRESH_TOKEN_USE",1e3)];case 3:if(!B.sent())return[3,24];(0,s.logDebugMessage)("onUnauthorisedResponse: lock acquired"),B.label=4;case 4:return B.trys.push([4,16,18,24]),[4,v(!1)];case 5:return w=B.sent(),w.status==="NOT_EXISTS"?((0,s.logDebugMessage)("onUnauthorisedResponse: Not refreshing because local session state is NOT_EXISTS"),f.config.onHandleEvent({action:"UNAUTHORISED",sessionExpiredOrRevoked:!1,userContext:{}}),[2,{result:"SESSION_EXPIRED"}]):w.status!==h.status||w.status==="EXISTS"&&h.status==="EXISTS"&&w.lastAccessTokenUpdate!==h.lastAccessTokenUpdate?((0,s.logDebugMessage)("onUnauthorisedResponse: Retrying early because pre and post lastAccessTokenUpdate don't match"),[2,{result:"RETRY"}]):(R=new Headers,h.status!=="EXISTS"?[3,7]:[4,d.getToken(h.lastAccessTokenUpdate)]);case 6:I=B.sent(),I!==void 0&&((0,s.logDebugMessage)("onUnauthorisedResponse: Adding anti-csrf token to refresh API call"),R.set("anti-csrf",I)),B.label=7;case 7:return(0,s.logDebugMessage)("onUnauthorisedResponse: Adding rid and fdi-versions to refresh call header"),R.set("rid",f.rid),R.set("fdi-version",n.supported_fdi.join(",")),C=f.config.tokenTransferMethod,(0,s.logDebugMessage)("onUnauthorisedResponse: Adding st-auth-mode header: "+C),R.set("st-auth-mode",C),[4,x(R,!0)];case 8:return B.sent(),(0,s.logDebugMessage)("onUnauthorisedResponse: Calling refresh pre API hook"),[4,f.config.preAPIHook({action:"REFRESH_SESSION",requestInit:{method:"post",credentials:"include",headers:R},url:f.refreshTokenUrl,userContext:{}})];case 9:return j=B.sent(),(0,s.logDebugMessage)("onUnauthorisedResponse: Making refresh call"),[4,f.env.__supertokensOriginalFetch(j.url,j.requestInit)];case 10:return X=B.sent(),(0,s.logDebugMessage)("onUnauthorisedResponse: Refresh call ended"),[4,me(X)];case 11:return B.sent(),(0,s.logDebugMessage)("onUnauthorisedResponse: Refresh status code is: "+X.status),fe=X.status===f.config.sessionExpiredStatusCode,fe&&X.headers.get("front-token")===null?[4,b.setItem("remove")]:[3,13];case 12:B.sent(),B.label=13;case 13:if(Bn(h.status==="EXISTS",X.status,fe&&X.headers.get("front-token")===null?"remove":X.headers.get("front-token")),X.status>=300)throw X;return[4,f.config.postAPIHook({action:"REFRESH_SESSION",fetchResponse:X.clone(),requestInit:j.requestInit,url:j.url,userContext:{}})];case 14:return B.sent(),[4,v(!1)];case 15:return B.sent().status==="NOT_EXISTS"?((0,s.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so returning session expired"),[2,{result:"SESSION_EXPIRED"}]):(f.config.onHandleEvent({action:"REFRESH_SESSION",userContext:{}}),(0,s.logDebugMessage)("onUnauthorisedResponse: Sending RETRY signal"),[2,{result:"RETRY"}]);case 16:return q=B.sent(),[4,v(!1)];case 17:return B.sent().status==="NOT_EXISTS"?((0,s.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so returning session expired"),[2,{result:"SESSION_EXPIRED",error:q}]):((0,s.logDebugMessage)("onUnauthorisedResponse: sending API_ERROR"),[2,{result:"API_ERROR",error:q}]);case 18:return[4,y.releaseLock("REFRESH_TOKEN_USE")];case 19:return B.sent(),(0,s.logDebugMessage)("onUnauthorisedResponse: Released lock"),[4,v(!1)];case 20:return B.sent().status!=="NOT_EXISTS"?[3,23]:((0,s.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,d.removeToken()]);case 21:return B.sent(),[4,b.removeToken()];case 22:B.sent(),B.label=23;case 23:return[7];case 24:return[4,v(!1)];case 25:return J=B.sent(),J.status==="NOT_EXISTS"?((0,s.logDebugMessage)("onUnauthorisedResponse: lock acquired failed and local session doesn't exist, so sending SESSION_EXPIRED"),[2,{result:"SESSION_EXPIRED"}]):J.status!==h.status||J.status==="EXISTS"&&h.status==="EXISTS"&&J.lastAccessTokenUpdate!==h.lastAccessTokenUpdate?((0,s.logDebugMessage)("onUnauthorisedResponse: lock acquired failed and retrying early because pre and post lastAccessTokenUpdate don't match"),[2,{result:"RETRY"}]):[3,2];case 26:return[2]}})})}e.onUnauthorisedResponse=m;function S(){(0,s.logDebugMessage)("onTokenUpdate: firing ACCESS_TOKEN_PAYLOAD_UPDATED event"),f.config.onHandleEvent({action:"ACCESS_TOKEN_PAYLOAD_UPDATED",userContext:{}})}e.onTokenUpdate=S;function N(h){return t(this,void 0,void 0,function(){var y;return i(this,function(w){switch(w.label){case 0:return w.trys.push([0,2,,3]),[4,f.recipeImpl.getInvalidClaimsFromResponse({response:h,userContext:{}})];case 1:return y=w.sent(),y&&f.config.onHandleEvent({action:"API_INVALID_CLAIM",claimValidationErrors:y,userContext:{}}),[3,3];case 2:return w.sent(),[3,3];case 3:return[2]}})})}e.onInvalidClaimResponse=N;function v(h){return t(this,void 0,void 0,function(){var y,w,R,I;return i(this,function(C){switch(C.label){case 0:return(0,s.logDebugMessage)("getLocalSessionState: called"),[4,T(k)];case 1:return y=C.sent(),[4,b.doesTokenExists()];case 2:return w=C.sent(),w&&y!==void 0?((0,s.logDebugMessage)("getLocalSessionState: returning EXISTS since both frontToken and lastAccessTokenUpdate exists"),[2,{status:"EXISTS",lastAccessTokenUpdate:y}]):[3,3];case 3:return y?((0,s.logDebugMessage)("getLocalSessionState: returning NOT_EXISTS since frontToken was cleared but lastAccessTokenUpdate exists"),[2,{status:"NOT_EXISTS"}]):[3,4];case 4:return R={status:"MAY_EXIST"},h?((0,s.logDebugMessage)("getLocalSessionState: trying to refresh"),[4,m(R)]):[3,7];case 5:return I=C.sent(),I.result!=="RETRY"?((0,s.logDebugMessage)("getLocalSessionState: return NOT_EXISTS in case error from backend"+I.result),[2,{status:"NOT_EXISTS"}]):((0,s.logDebugMessage)("getLocalSessionState: Retrying post refresh"),[4,v(h)]);case 6:return[2,C.sent()];case 7:return(0,s.logDebugMessage)("getLocalSessionState: returning: "+R.status),[2,R]}})})}e.getLocalSessionState=v;function g(h){switch(h){case"access":return U;case"refresh":return H}}e.getStorageNameForToken=g;function P(h,y){var w=g(h);return y!==""?((0,s.logDebugMessage)("setToken: saved ".concat(h," token into cookies")),A(w,y,Date.now()+31536e5)):((0,s.logDebugMessage)("setToken: cleared ".concat(h," token from cookies")),A(w,y,0))}e.setToken=P;function A(h,y,w){var R="Fri, 31 Dec 9999 23:59:59 GMT";w!==Number.MAX_SAFE_INTEGER&&(R=new Date(w).toUTCString());var I=f.config.sessionTokenFrontendDomain;return I==="localhost"||I===u.default.getReferenceOrThrow().windowHandler.location.getHostName()?a.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(h,"=").concat(y,";expires=").concat(R,";path=/;samesite=").concat(f.config.isInIframe?"none;secure":"lax")):a.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(h,"=").concat(y,";expires=").concat(R,";domain=").concat(I,";path=/;samesite=").concat(f.config.isInIframe?"none;secure":"lax"))}function _(h){return t(this,void 0,void 0,function(){var y;return i(this,function(w){return y=g(h),[2,T(y)]})})}e.getTokenForHeaderAuth=_;function T(h){return t(this,void 0,void 0,function(){var y,w,R,I;return i(this,function(C){switch(C.label){case 0:return w="; ",[4,a.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:return y=w+C.sent(),R=y.split("; "+h+"="),R.length>=2&&(I=R.pop(),I!==void 0)?[2,I.split(";").shift()]:[2,void 0]}})})}function x(h,y){return y===void 0&&(y=!1),t(this,void 0,void 0,function(){var w,R;return i(this,function(I){switch(I.label){case 0:return(0,s.logDebugMessage)("setTokenHeaders: adding existing tokens as header"),[4,_("access")];case 1:return w=I.sent(),[4,_("refresh")];case 2:return R=I.sent(),(y||w!==void 0)&&R!==void 0?h.has("Authorization")?(0,s.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):((0,s.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),h.set("Authorization","Bearer ".concat(y?R:w))):(0,s.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"),[2]}})})}function me(h){return t(this,void 0,void 0,function(){var y,w,R,I,C;return i(this,function(j){switch(j.label){case 0:return(0,s.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response headers"),y=h.headers.get("st-refresh-token"),y===null?[3,2]:((0,s.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,P("refresh",y)]);case 1:j.sent(),j.label=2;case 2:return w=h.headers.get("st-access-token"),w===null?[3,4]:((0,s.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,P("access",w)]);case 3:j.sent(),j.label=4;case 4:return R=h.headers.get("front-token"),R===null?[3,6]:((0,s.logDebugMessage)("saveTokensFromHeaders: Setting sFrontToken: "+R),[4,b.setItem(R)]);case 5:j.sent(),(0,e.updateClockSkewUsingFrontToken)({frontToken:R,responseHeaders:h.headers}),j.label=6;case 6:return I=h.headers.get("anti-csrf"),I===null?[3,9]:[4,v(!0)];case 7:return C=j.sent(),C.status!=="EXISTS"?[3,9]:((0,s.logDebugMessage)("saveTokensFromHeaders: Setting anti-csrf token"),[4,d.setItem(C.lastAccessTokenUpdate,I)]);case 8:j.sent(),j.label=9;case 9:return[2]}})})}var yt=void 0;function Ue(){return t(this,void 0,void 0,function(){var h;return i(this,function(y){switch(y.label){case 0:return(0,s.logDebugMessage)("saveLastAccessTokenUpdate: called"),h=Date.now().toString(),(0,s.logDebugMessage)("saveLastAccessTokenUpdate: setting "+h),[4,A(k,h,Number.MAX_SAFE_INTEGER)];case 1:return y.sent(),yt!==void 0?[3,3]:[4,T(k)];case 2:yt=y.sent()===h,y.label=3;case 3:return yt===!1&&console.warn("Saving to cookies was not successful, this indicates a configuration error or the browser preventing us from writing the cookies (e.g.: incognito mode)."),[4,A("sIRTFrontend","",0)];case 4:return y.sent(),[2]}})})}e.saveLastAccessTokenUpdate=Ue;function Vn(){return t(this,void 0,void 0,function(){function h(){return t(this,void 0,void 0,function(){var w,R,I,C,j;return i(this,function(X){switch(X.label){case 0:return R="; ",[4,a.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:return w=R+X.sent(),I=w.split("; "+M+"="),I.length>=2&&(C=I.pop(),C!==void 0)?(j=C.split(";").shift(),j===void 0?[2,null]:[2,j]):[2,null]}})})}var y;return i(this,function(w){switch(w.label){case 0:return(0,s.logDebugMessage)("getAntiCSRFToken: called"),[4,v(!0)];case 1:return w.sent().status!=="EXISTS"?((0,s.logDebugMessage)("getAntiCSRFToken: Returning because local session state != EXISTS"),[2,null]):[4,h()];case 2:return y=w.sent(),(0,s.logDebugMessage)("getAntiCSRFToken: returning: "+y),[2,y]}})})}function Ne(h){return t(this,void 0,void 0,function(){return i(this,function(y){switch(y.label){case 0:return(0,s.logDebugMessage)("setAntiCSRF: called: "+h),h===void 0?[3,2]:[4,A(M,h,Number.MAX_SAFE_INTEGER)];case 1:return y.sent(),[3,4];case 2:return[4,A(M,"",0)];case 3:y.sent(),y.label=4;case 4:return[2]}})})}e.setAntiCSRF=Ne;function Qe(){return t(this,void 0,void 0,function(){var h;return i(this,function(y){switch(y.label){case 0:return(0,s.logDebugMessage)("getFrontTokenFromCookie: called"),[4,T(O)];case 1:return h=y.sent(),[2,h===void 0?null:h]}})})}function L(h){return JSON.parse(decodeURIComponent(escape(atob(h))))}function Z(){return t(this,void 0,void 0,function(){var h;return i(this,function(y){switch(y.label){case 0:return(0,s.logDebugMessage)("getFrontToken: called"),[4,v(!0)];case 1:return y.sent().status!=="EXISTS"?((0,s.logDebugMessage)("getFrontToken: Returning because sIRTFrontend != EXISTS"),[2,null]):[4,Qe()];case 2:return h=y.sent(),(0,s.logDebugMessage)("getFrontToken: returning: "+h),[2,h]}})})}e.getFrontToken=Z;function we(h){return t(this,void 0,void 0,function(){var y,w,R;return i(this,function(I){switch(I.label){case 0:return(0,s.logDebugMessage)("setFrontToken: called"),[4,Qe()];case 1:return y=I.sent(),y!==null&&h!==void 0&&(w=L(y).up,R=L(h).up,JSON.stringify(w)!==JSON.stringify(R)&&S()),h!==void 0?[3,3]:[4,A(O,"",0)];case 2:return I.sent(),[3,5];case 3:return[4,A(O,h,Number.MAX_SAFE_INTEGER)];case 4:I.sent(),I.label=5;case 5:return[2]}})})}e.setFrontToken=we;function Bn(h,y,w){if(w==null){(0,s.logDebugMessage)("fireSessionUpdateEventsIfNecessary returning early because the front token was not updated");return}var R=w!=="remove";(0,s.logDebugMessage)("fireSessionUpdateEventsIfNecessary wasLoggedIn: ".concat(h," frontTokenExistsAfter: ").concat(R," status: ").concat(y)),h?R||(y===f.config.sessionExpiredStatusCode?((0,s.logDebugMessage)("onUnauthorisedResponse: firing UNAUTHORISED event"),f.config.onHandleEvent({action:"UNAUTHORISED",sessionExpiredOrRevoked:!0,userContext:{}})):((0,s.logDebugMessage)("onUnauthorisedResponse: firing SIGN_OUT event"),f.config.onHandleEvent({action:"SIGN_OUT",userContext:{}}))):R&&((0,s.logDebugMessage)("onUnauthorisedResponse: firing SESSION_CREATED event"),f.config.onHandleEvent({action:"SESSION_CREATED",userContext:{}}))}e.fireSessionUpdateEventsIfNecessary=Bn;var la=function(h){var y=h.frontToken,w=h.responseHeaders;if((0,s.logDebugMessage)("updateClockSkewUsingFrontToken: frontToken: "+y),y==null||y==="remove"){(0,s.logDebugMessage)("updateClockSkewUsingFrontToken: the access token payload wasn't updated or is being removed, skipping clock skew update");return}var R=L(y),I=f.recipeImpl.calculateClockSkewInMillis({accessTokenPayload:R.up,responseHeaders:w});l.default.getReferenceOrThrow().dateProvider.setClientClockSkewInMillis(I),(0,s.logDebugMessage)("updateClockSkewUsingFrontToken: Client clock synchronized successfully")};e.updateClockSkewUsingFrontToken=la}(Ge);var Xe={};Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.SessionClaimValidatorStore=void 0;var Mr=function(){function e(){}return e.claimValidatorsAddedByOtherRecipes=[],e.addClaimValidatorFromOtherRecipe=function(r){e.claimValidatorsAddedByOtherRecipes.push(r)},e.getClaimValidatorsAddedByOtherRecipes=function(){return e.claimValidatorsAddedByOtherRecipes},e}();Xe.SessionClaimValidatorStore=Mr,Xe.default=Mr,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.getGlobalClaimValidators=void 0;var di=te,fi=Ge,hi=Xe;function gi(e,r){var t=(0,di.getNormalisedUserContext)(r),i=hi.default.getClaimValidatorsAddedByOtherRecipes(),o=fi.default.recipeImpl.getGlobalClaimValidators({claimValidatorsAddedByOtherRecipes:i,userContext:t}),n=e!==void 0?e(o,t):o;return n}Dt.getGlobalClaimValidators=gi,function(e){function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}e.__esModule=!0,r(Dt)}(wr),Object.defineProperty(G,"__esModule",{value:!0}),G.normaliseUser=G.normaliseUserResponse=G.getGlobalClaimValidators=G.getHashFromLocation=G.getNormalisedUserContext=G.checkForSSRErrorAndAppendIfNeeded=G.getAllQueryParams=G.getQueryParams=G.isTest=G.normaliseInputAppInfoOrThrowError=G.appendQueryParamsToURL=void 0;var Pn=pn,xr=Be,vi=mn,Lt=Ot,pi=wr;function mi(e,r){if(r===void 0)return e;try{var t=new URL(e);return Object.entries(r).forEach(function(n){var a=n[0],u=n[1];t.searchParams.set(a,u)}),t.href}catch{var i=e.startsWith("/")?"http:localhost":"http://localhost/",o=new URL("".concat(i).concat(e));return Object.entries(r).forEach(function(a){var u=a[0],c=a[1];o.searchParams.set(u,c)}),"".concat(o.pathname).concat(o.search)}}G.appendQueryParamsToURL=mi;function wi(e,r){return r!==void 0?new Lt.default(r):new Lt.default(e)}function yi(e){if(e===void 0)throw new Error("Please provide the appInfo object when calling supertokens.init");if(e.apiDomain===void 0)throw new Error("Please provide your apiDomain inside the appInfo object when calling supertokens.init");if(e.appName===void 0)throw new Error("Please provide your appName inside the appInfo object when calling supertokens.init");var r=new Lt.default("");return e.apiGatewayPath!==void 0&&(r=new Lt.default(e.apiGatewayPath)),{appName:e.appName,apiDomain:new vi.default(e.apiDomain),apiBasePath:r.appendPath(wi(xr.DEFAULT_API_BASE_PATH,e.apiBasePath))}}G.normaliseInputAppInfoOrThrowError=yi;function bi(){try{return process.env.TEST_MODE==="testing"}catch{return!1}}G.isTest=bi;function ki(e){var r=new URLSearchParams(Pn.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getSearch()),t=r.get(e);if(t!==null)return t}G.getQueryParams=ki;function Ri(){return new URLSearchParams(Pn.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getSearch())}G.getAllQueryParams=Ri;function Ii(e){return typeof window>"u"&&(e=e+xr.SSR_ERROR),e}G.checkForSSRErrorAndAppendIfNeeded=Ii;function Si(e){return e===void 0?{}:e}G.getNormalisedUserContext=Si;function Ti(){return Pn.WindowHandlerReference.getReferenceOrThrow().windowHandler.location.getHash().substring(1)}G.getHashFromLocation=Ti;function _i(e){var r=e.overrideGlobalClaimValidators,t=e.userContext;return(0,pi.getGlobalClaimValidators)(r,t)}G.getGlobalClaimValidators=_i;function Ei(e,r){return"createdNewRecipeUser"in r?r:{createdNewRecipeUser:r.createdNewUser,user:Hr(e,r.user)}}G.normaliseUserResponse=Ei;function Hr(e,r){if("loginMethods"in r)return r;var t=r.email!==void 0?[r.email]:[],i=r.phoneNumber!==void 0?[r.phoneNumber]:[],o=r.thirdParty!==void 0?[r.thirdParty]:[];return{id:r.id,emails:t,phoneNumbers:i,thirdParty:o,isPrimaryUser:!1,tenantIds:r.tenantIds,timeJoined:r.timeJoined,loginMethods:[{recipeId:e,recipeUserId:r.id,timeJoined:r.timeJoined,tenantIds:r.tenantIds,email:r.email,phoneNumber:r.email}]}}G.normaliseUser=Hr;var ze={},Ut={};Object.defineProperty(Ut,"__esModule",{value:!0});var Ci=function(){function e(r){this.config=r}return e}();Ut.default=Ci;var On={},Fr={},Dn={},ke={},Nt={},Ai=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},Pi=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.createAxiosErrorFromFetchResp=void 0;function Oi(e,r,t,i,o){return e.config=r,t&&(e.code=t),e.request=i,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}function Di(e){return Ai(this,void 0,void 0,function(){var r,t,i,o,n;return Pi(this,function(a){switch(a.label){case 0:if(r={url:e.url,headers:e.headers},t="status"in e,!t)return[3,12];if(o=e.headers.get("content-type"),n=void 0,o!==null)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e.text()];case 2:return n=a.sent(),[3,4];case 3:return a.sent(),n="",[3,4];case 4:return[3,11];case 5:return o.includes("application/json")?[4,e.json()]:[3,7];case 6:return n=a.sent(),[3,11];case 7:return o.includes("text/")?[4,e.text()]:[3,9];case 8:return n=a.sent(),[3,11];case 9:return[4,e.blob()];case 10:n=a.sent(),a.label=11;case 11:i={data:n,status:e.status,statusText:e.statusText,headers:e.headers,config:r,request:void 0},a.label=12;case 12:return[2,Oi(t?new Error("Request failed with status code "+e.status):e,r,e.code,void 0,i)]}})})}Nt.createAxiosErrorFromFetchResp=Di;var z=p&&p.__assign||function(){return z=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},z.apply(this,arguments)},Me=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},xe=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(ke,"__esModule",{value:!0}),ke.responseErrorInterceptor=ke.responseInterceptor=ke.interceptorFunctionRequestFulfilled=void 0;var Mi=Nt,E=Ge,qt=Mt,Mn=ie,D=oe;function xi(e){e.__supertokensSessionRefreshAttempts===void 0&&(e.__supertokensSessionRefreshAttempts=0),e.__supertokensSessionRefreshAttempts++}function Hi(e){return e.__supertokensSessionRefreshAttempts===void 0&&(e.__supertokensSessionRefreshAttempts=0),e.__supertokensSessionRefreshAttempts>=E.default.config.maxRetryAttemptsForSessionRefresh}function xn(e){var r=e.url===void 0?"":e.url,t=e.baseURL;return t!==void 0&&(r.charAt(0)==="/"&&t.charAt(t.length-1)==="/"?r=t+r.substr(1):r.charAt(0)!=="/"&&t.charAt(t.length-1)!=="/"?r=t+"/"+r:r=t+r),r}function Fi(e){return Me(this,void 0,void 0,function(){var r,t,i,o,n,a;return xe(this,function(u){switch(u.label){case 0:(0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: started axios interception"),r=xn(e),t=!1;try{t=typeof r=="string"&&!E.default.recipeImpl.shouldDoInterceptionBasedOnUrl(r,E.default.config.apiDomain,E.default.config.sessionTokenBackendDomain)}catch(c){if(c.message==="Please provide a valid domain name")(0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: Trying shouldDoInterceptionBasedOnUrl with location.origin"),t=!E.default.recipeImpl.shouldDoInterceptionBasedOnUrl(Mn.default.getReferenceOrThrow().windowHandler.location.getOrigin(),E.default.config.apiDomain,E.default.config.sessionTokenBackendDomain);else throw c}return(0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: Value of doNotDoInterception: "+t),t?((0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: Returning config unchanged"),[2,e]):((0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: Modifying config"),qt.ProcessState.getInstance().addState(qt.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),[4,(0,E.getLocalSessionState)(!0)]);case 1:return i=u.sent(),o=e,i.status!=="EXISTS"?[3,3]:[4,E.AntiCsrfToken.getToken(i.lastAccessTokenUpdate)];case 2:n=u.sent(),n!==void 0&&((0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding anti-csrf token to request"),o=z(z({},o),{headers:o===void 0?{"anti-csrf":n}:z(z({},o.headers),{"anti-csrf":n})})),u.label=3;case 3:return E.default.config.autoAddCredentials&&o.withCredentials===void 0&&((0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding credentials include"),o=z(z({},o),{withCredentials:!0})),(0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding rid header: anti-csrf (it may be overriden by the user's provided rid)"),o=z(z({},o),{headers:o===void 0?{rid:"anti-csrf"}:z({rid:"anti-csrf"},o.headers)}),a=E.default.config.tokenTransferMethod,(0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding st-auth-mode header: "+a),o.headers["st-auth-mode"]=a,[4,Ur(o)];case 4:return o=u.sent(),[4,Lr(o)];case 5:return u.sent(),(0,D.logDebugMessage)("interceptorFunctionRequestFulfilled: returning modified config"),[2,o]}})})}ke.interceptorFunctionRequestFulfilled=Fi;function Li(e){var r=this;return function(t){return Me(r,void 0,void 0,function(){var i,o,n,a,u;return xe(this,function(c){switch(c.label){case 0:i=!1,c.label=1;case 1:if(c.trys.push([1,,8,14]),!E.default.initCalled)throw new Error("init function not called");(0,D.logDebugMessage)("responseInterceptor: started"),(0,D.logDebugMessage)("responseInterceptor: already intercepted: "+t.headers["x-supertokens-xhr-intercepted"]),o=xn(t.config);try{i=typeof o=="string"&&!E.default.recipeImpl.shouldDoInterceptionBasedOnUrl(o,E.default.config.apiDomain,E.default.config.sessionTokenBackendDomain)||!!t.headers["x-supertokens-xhr-intercepted"]}catch(s){if(s.message==="Please provide a valid domain name")(0,D.logDebugMessage)("responseInterceptor: Trying shouldDoInterceptionBasedOnUrl with location.origin"),i=!E.default.recipeImpl.shouldDoInterceptionBasedOnUrl(Mn.default.getReferenceOrThrow().windowHandler.location.getOrigin(),E.default.config.apiDomain,E.default.config.sessionTokenBackendDomain)||!!t.headers["x-supertokens-xhr-intercepted"];else throw s}return(0,D.logDebugMessage)("responseInterceptor: Value of doNotDoInterception: "+i),i?((0,D.logDebugMessage)("responseInterceptor: Returning without interception"),[2,t]):((0,D.logDebugMessage)("responseInterceptor: Interception started"),qt.ProcessState.getInstance().addState(qt.PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE),[4,(0,E.getLocalSessionState)(!1)]);case 2:return n=c.sent(),[4,Fn(t)];case 3:return c.sent(),(0,E.fireSessionUpdateEventsIfNecessary)(n.status==="EXISTS",t.status,t.headers["front-token"]),t.status!==E.default.config.sessionExpiredStatusCode?[3,4]:((0,D.logDebugMessage)("responseInterceptor: Status code is: "+t.status),a=t.config,[2,Hn.doRequest(function(s){return e(s)},a,o,t,void 0,!0)]);case 4:return t.status!==E.default.config.invalidClaimStatusCode?[3,6]:[4,(0,E.onInvalidClaimResponse)(t)];case 5:c.sent(),c.label=6;case 6:return[2,t];case 7:return[3,14];case 8:return u=!i,u?[4,(0,E.getLocalSessionState)(!0)]:[3,10];case 9:u=c.sent().status!=="EXISTS",c.label=10;case 10:return u?((0,D.logDebugMessage)("responseInterceptor: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,E.AntiCsrfToken.removeToken()]):[3,13];case 11:return c.sent(),[4,E.FrontToken.removeToken()];case 12:c.sent(),c.label=13;case 13:return[7];case 14:return[2]}})})}}ke.responseInterceptor=Li;function Ui(e){var r=this;return function(t){return Me(r,void 0,void 0,function(){var i;return xe(this,function(o){switch(o.label){case 0:if((0,D.logDebugMessage)("responseErrorInterceptor: called"),(0,D.logDebugMessage)("responseErrorInterceptor: already intercepted: "+(t.response&&t.response.headers["x-supertokens-xhr-intercepted"])),t.response===void 0||t.response.headers["x-supertokens-xhr-intercepted"])throw t;return t.response!==void 0&&t.response.status===E.default.config.sessionExpiredStatusCode?((0,D.logDebugMessage)("responseErrorInterceptor: Status code is: "+t.response.status),i=t.config,[2,Hn.doRequest(function(n){return e(n)},i,xn(i),void 0,t,!0)]):[3,1];case 1:return t.response!==void 0&&t.response.status===E.default.config.invalidClaimStatusCode?[4,(0,E.onInvalidClaimResponse)(t.response)]:[3,3];case 2:o.sent(),o.label=3;case 3:throw t}})})}}ke.responseErrorInterceptor=Ui;var Hn=function(){function e(){}var r;return r=e,e.doRequest=function(t,i,o,n,a,u){return u===void 0&&(u=!1),Me(void 0,void 0,void 0,function(){var c,s,l,d,b,f,k,H,O,U,M,O,m,S,N,v;return xe(r,function(g){switch(g.label){case 0:if(!E.default.initCalled)throw Error("init function not called");(0,D.logDebugMessage)("doRequest: called"),c=!1;try{c=typeof o=="string"&&!E.default.recipeImpl.shouldDoInterceptionBasedOnUrl(o,E.default.config.apiDomain,E.default.config.sessionTokenBackendDomain)&&u}catch(P){if(P.message==="Please provide a valid domain name")(0,D.logDebugMessage)("doRequest: Trying shouldDoInterceptionBasedOnUrl with location.origin"),c=!E.default.recipeImpl.shouldDoInterceptionBasedOnUrl(Mn.default.getReferenceOrThrow().windowHandler.location.getOrigin(),E.default.config.apiDomain,E.default.config.sessionTokenBackendDomain)&&u;else throw P}if((0,D.logDebugMessage)("doRequest: Value of doNotDoInterception: "+c),!c)return[3,2];if((0,D.logDebugMessage)("doRequest: Returning without interception"),a!==void 0)throw a;return n!==void 0?[2,n]:[4,t(i)];case 1:return[2,g.sent()];case 2:return(0,D.logDebugMessage)("doRequest: Interception started"),[4,Ur(i)];case 3:i=g.sent(),g.label=4;case 4:g.trys.push([4,,30,35]),s=void 0,g.label=5;case 5:return[4,(0,E.getLocalSessionState)(!0)];case 6:return l=g.sent(),d=i,l.status!=="EXISTS"?[3,8]:[4,E.AntiCsrfToken.getToken(l.lastAccessTokenUpdate)];case 7:b=g.sent(),b!==void 0&&((0,D.logDebugMessage)("doRequest: Adding anti-csrf token to request"),d=z(z({},d),{headers:d===void 0?{"anti-csrf":b}:z(z({},d.headers),{"anti-csrf":b})})),g.label=8;case 8:return E.default.config.autoAddCredentials&&d.withCredentials===void 0&&((0,D.logDebugMessage)("doRequest: Adding credentials include"),d=z(z({},d),{withCredentials:!0})),(0,D.logDebugMessage)("doRequest: Adding rid header: anti-csrf (May get overriden by user's rid)"),d=z(z({},d),{headers:d===void 0?{rid:"anti-csrf"}:z({rid:"anti-csrf"},d.headers)}),f=E.default.config.tokenTransferMethod,(0,D.logDebugMessage)("doRequest: Adding st-auth-mode header: "+f),d.headers["st-auth-mode"]=f,[4,Lr(d)];case 9:g.sent(),g.label=10;case 10:if(g.trys.push([10,15,,28]),k=a,H=n,a=void 0,n=void 0,k!==void 0)throw(0,D.logDebugMessage)("doRequest: Not making call because localPrevError is not undefined"),k;return H!==void 0?(0,D.logDebugMessage)("doRequest: Not making call because localPrevResponse is not undefined"):(0,D.logDebugMessage)("doRequest: Making user's http call"),H!==void 0?[3,12]:[4,t(d)];case 11:return U=g.sent(),[3,13];case 12:U=H,g.label=13;case 13:return O=U,(0,D.logDebugMessage)("doRequest: User's http call ended"),[4,Fn(O)];case 14:return g.sent(),(0,E.fireSessionUpdateEventsIfNecessary)(l.status==="EXISTS",O.status,O.headers["front-token"]),[2,O];case 15:return M=g.sent(),O=M.response,O===void 0?[3,26]:[4,Fn(O)];case 16:if(g.sent(),(0,E.fireSessionUpdateEventsIfNecessary)(l.status==="EXISTS",O.status,O.headers["front-token"]),O.status!==E.default.config.sessionExpiredStatusCode)return[3,22];if((0,D.logDebugMessage)("doRequest: Status code is: "+O.status),Hi(i))throw(0,D.logDebugMessage)("doRequest: Maximum session refresh attempts reached. sessionRefreshAttempts: ".concat(i.__supertokensSessionRefreshAttempts,", maxRetryAttemptsForSessionRefresh: ").concat(E.default.config.maxRetryAttemptsForSessionRefresh)),m="Received a 401 response from ".concat(o,". Attempted to refresh the session and retry the request with the updated session tokens ").concat(E.default.config.maxRetryAttemptsForSessionRefresh," times, but each attempt resulted in a 401 error. The maximum session refresh limit has been reached. Please investigate your API. To increase the session refresh attempts, update maxRetryAttemptsForSessionRefresh in the config."),console.error(m),new Error(m);return[4,(0,E.onUnauthorisedResponse)(l)];case 17:return S=g.sent(),xi(i),(0,D.logDebugMessage)("doRequest: sessionRefreshAttempts: "+i.__supertokensSessionRefreshAttempts),console.log("!!!!",JSON.stringify(S)),S.result==="RETRY"?[3,21]:((0,D.logDebugMessage)("doRequest: Not retrying original request"),S.error===void 0?[3,19]:[4,(0,Mi.createAxiosErrorFromFetchResp)(S.error)]);case 18:return N=g.sent(),[3,20];case 19:N=M,g.label=20;case 20:return s=N,[3,29];case 21:return(0,D.logDebugMessage)("doRequest: Retrying original request"),[3,25];case 22:return O.status!==E.default.config.invalidClaimStatusCode?[3,24]:[4,(0,E.onInvalidClaimResponse)(O)];case 23:g.sent(),g.label=24;case 24:throw M;case 25:return[3,27];case 26:throw M;case 27:return[3,28];case 28:return[3,5];case 29:throw s;case 30:return[4,(0,E.getLocalSessionState)(!1)];case 31:return v=g.sent(),v.status!=="NOT_EXISTS"?[3,34]:((0,D.logDebugMessage)("doRequest: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,E.AntiCsrfToken.removeToken()]);case 32:return g.sent(),[4,E.FrontToken.removeToken()];case 33:g.sent(),g.label=34;case 34:return[7];case 35:return[2]}})})},e}();ke.default=Hn;function Lr(e){return Me(this,void 0,void 0,function(){var r,t;return xe(this,function(i){switch(i.label){case 0:return e.headers===void 0&&(e.headers={}),(0,D.logDebugMessage)("setAuthorizationHeaderIfRequired: adding existing tokens as header"),[4,(0,E.getTokenForHeaderAuth)("access")];case 1:return r=i.sent(),[4,(0,E.getTokenForHeaderAuth)("refresh")];case 2:return t=i.sent(),r!==void 0&&t!==void 0?e.headers.Authorization!==void 0||e.headers.authorization!==void 0?(0,D.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):((0,D.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),e.headers=z(z({},e.headers),{Authorization:"Bearer ".concat(r)}),e.__supertokensAddedAuthHeader=!0):(0,D.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"),[2]}})})}function Fn(e){return Me(this,void 0,void 0,function(){var r,t,i,o,n,a;return xe(this,function(u){switch(u.label){case 0:return(0,D.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response"),r=e.headers["st-refresh-token"],r===void 0?[3,2]:((0,D.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,(0,E.setToken)("refresh",r)]);case 1:u.sent(),u.label=2;case 2:return t=e.headers["st-access-token"],t===void 0?[3,4]:((0,D.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,(0,E.setToken)("access",t)]);case 3:u.sent(),u.label=4;case 4:return i=e.headers["front-token"],i===void 0?[3,6]:((0,D.logDebugMessage)("doRequest: Setting sFrontToken: "+i),[4,E.FrontToken.setItem(i)]);case 5:u.sent(),o=new Headers,Object.entries(e.headers).forEach(function(c){var s=c[0],l=c[1];Array.isArray(l)?l.forEach(function(d){return o.append(s,d)}):o.append(s,l)}),(0,E.updateClockSkewUsingFrontToken)({frontToken:i,responseHeaders:o}),u.label=6;case 6:return n=e.headers["anti-csrf"],n===void 0?[3,9]:[4,(0,E.getLocalSessionState)(!0)];case 7:return a=u.sent(),a.status!=="EXISTS"?[3,9]:((0,D.logDebugMessage)("doRequest: Setting anti-csrf token"),[4,E.AntiCsrfToken.setItem(a.lastAccessTokenUpdate,n)]);case 8:u.sent(),u.label=9;case 9:return[2]}})})}function Ur(e){return Me(this,void 0,void 0,function(){var r,t,i,o;return xe(this,function(n){switch(n.label){case 0:return[4,(0,E.getTokenForHeaderAuth)("access")];case 1:return r=n.sent(),[4,(0,E.getTokenForHeaderAuth)("refresh")];case 2:return t=n.sent(),i=e.headers.Authorization||e.headers.authorization,r!==void 0&&t!==void 0&&(i==="Bearer ".concat(r)||"__supertokensAddedAuthHeader"in e)?((0,D.logDebugMessage)("removeAuthHeaderIfMatchesLocalToken: Removing Authorization from user provided headers because it contains our access token"),o=z(z({},e),{headers:z({},e.headers)}),delete o.headers.authorization,delete o.headers.Authorization,[2,o]):[2,e]}})})}var it={},Ni=p&&p.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function i(){this.constructor=r}r.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.STGeneralError=void 0;var qi=function(e){Ni(r,e);function r(t){var i=e.call(this,t)||this;return i.isSuperTokensGeneralError=!0,i}return r.isThisError=function(t){return t.isSuperTokensGeneralError===!0},r}(Error);it.STGeneralError=qi;var jt={},He=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},Fe=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(jt,"__esModule",{value:!0}),jt.addInterceptorsToXMLHttpRequest=void 0;var $=Ge,F=oe,ji=ie,$t=Mt,$i=["readystatechange","abort","error","load","loadend","loadstart","progress","timeout"];function Vi(){var e=new Promise(function(t){return setTimeout(t,0)}),r=XMLHttpRequest;(0,F.logDebugMessage)("addInterceptorsToXMLHttpRequest called"),XMLHttpRequest=function(){var t=new r,i=e;function o(v){i=i.finally(function(){var g;return(g=v())===null||g===void 0?void 0:g.catch(console.error)})}var n=this,a=[],u=[],c={},s,l=new Map,d="",b=!1,f=void 0,k,H=0;n.onload=null,n.onreadystatechange=null,n.onloadend=null,n.addEventListener=function(v,g,P){var A=l.get(v);A===void 0&&(A=new Set,l.set(v,A)),A.add(g)},n.removeEventListener=function(v,g){var P=l.get(v);P===void 0&&(P=new Set,l.set(v,P)),P.delete(g)};function U(v,g){var P=l.get(v);(0,F.logDebugMessage)("XHRInterceptor dispatching ".concat(g.type," to ").concat(P?P.size:0," listeners")),P&&Array.from(P).forEach(function(A){return A.apply(n,[g])})}function M(){return He(this,void 0,void 0,function(){var v,g,P;return Fe(this,function(A){switch(A.label){case 0:if(f===void 0)throw new Error("Should never come here..");if((0,F.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: preRequestLSS "+f.status),H>=$.default.config.maxRetryAttemptsForSessionRefresh)throw(0,F.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Maximum session refresh attempts reached. sessionRefreshAttempts: ".concat(H,", maxRetryAttemptsForSessionRefresh: ").concat($.default.config.maxRetryAttemptsForSessionRefresh)),c.status=0,c.statusText="",c.responseType="",v="Received a 401 response from ".concat(d,". Attempted to refresh the session and retry the request with the updated session tokens ").concat($.default.config.maxRetryAttemptsForSessionRefresh," times, but each attempt resulted in a 401 error. The maximum session refresh limit has been reached. Please investigate your API. To increase the session refresh attempts, update maxRetryAttemptsForSessionRefresh in the config."),console.error(v),new Error(v);return[4,(0,$.onUnauthorisedResponse)(f)];case 1:if(g=A.sent(),H++,(0,F.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: sessionRefreshAttempts: "+H),g.result!=="RETRY"){if((0,F.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Not retrying original request "+!!g.error),g.error!==void 0)throw g.error;return[2,!0]}return(0,F.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Retrying original request"),P=new r,S(n,P,!0),a.forEach(function(_){_(P)}),N(P,k),[2,!1]}})})}function O(v){return He(this,void 0,void 0,function(){var g,P,A,_,T;return Fe(this,function(x){switch(x.label){case 0:if(b)return(0,F.logDebugMessage)("XHRInterceptor.handleResponse: Returning without interception"),[2,!0];x.label=1;case 1:x.trys.push([1,14,,18]),x.label=2;case 2:return x.trys.push([2,,8,13]),(0,F.logDebugMessage)("XHRInterceptor.handleResponse: Interception started"),$t.ProcessState.getInstance().addState($t.PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE),g=v.status,P=Xi(v),[4,Wi(P)];case 3:return x.sent(),(0,$.fireSessionUpdateEventsIfNecessary)(f.status==="EXISTS",g,P.get("front-token")),g!==$.default.config.sessionExpiredStatusCode?[3,5]:((0,F.logDebugMessage)("responseInterceptor: Status code is: "+g),[4,M()]);case 4:return[2,x.sent()];case 5:return g!==$.default.config.invalidClaimStatusCode?[3,7]:[4,(0,$.onInvalidClaimResponse)({data:v.responseText})];case 6:x.sent(),x.label=7;case 7:return[2,!0];case 8:return(0,F.logDebugMessage)("XHRInterceptor.handleResponse: doFinallyCheck running"),[4,(0,$.getLocalSessionState)(!1)];case 9:return x.sent().status==="EXISTS"?[3,12]:((0,F.logDebugMessage)("XHRInterceptor.handleResponse: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,$.AntiCsrfToken.removeToken()]);case 10:return x.sent(),[4,$.FrontToken.removeToken()];case 11:x.sent(),x.label=12;case 12:return[7];case 13:return[3,18];case 14:return A=x.sent(),(0,F.logDebugMessage)("XHRInterceptor.handleResponse: caught error"),A.status===void 0?[3,16]:[4,Bi(A)];case 15:if(_=x.sent(),c.status=_.status,c.statusText=_.statusText,c.responseType=_.responseType,s=_.headers,_.responseType==="json")try{c.response=JSON.parse(_.responseText)}catch{c.response=_.responseText}else c.response=_.responseText;return c.responseText=_.responseText,[3,17];case 16:T=new ProgressEvent("error"),T.error=A,n.onerror!==void 0&&n.onerror!==null&&n.onerror(T),U("error",T),x.label=17;case 17:return[2,!0];case 18:return[2]}})})}n.open=function(v,g){(0,F.logDebugMessage)("XHRInterceptor.open called");var P=arguments;d=g;try{b=typeof d=="string"&&!$.default.recipeImpl.shouldDoInterceptionBasedOnUrl(d,$.default.config.apiDomain,$.default.config.sessionTokenBackendDomain)||typeof d!="string"&&!$.default.recipeImpl.shouldDoInterceptionBasedOnUrl(d.toString(),$.default.config.apiDomain,$.default.config.sessionTokenBackendDomain)}catch(A){if(A.message==="Please provide a valid domain name")(0,F.logDebugMessage)("XHRInterceptor.open: Trying shouldDoInterceptionBasedOnUrl with location.origin"),b=!$.default.recipeImpl.shouldDoInterceptionBasedOnUrl(ji.default.getReferenceOrThrow().windowHandler.location.getOrigin(),$.default.config.apiDomain,$.default.config.sessionTokenBackendDomain);else throw A}o(function(){a.push(function(A){A.open.apply(A,P)}),t.open.apply(t,P)})},n.send=function(v){k=v,N(t,k)},n.setRequestHeader=function(v,g){var P=this;if((0,F.logDebugMessage)("XHRInterceptor.setRequestHeader: Called with ".concat(v)),b){o(function(){return t.setRequestHeader(v,g)});return}v!=="anti-csrf"&&o(function(){return He(P,void 0,void 0,function(){var A,_;return Fe(this,function(T){switch(T.label){case 0:return v.toLowerCase()!=="authorization"?[3,3]:((0,F.logDebugMessage)("XHRInterceptor.setRequestHeader: checking if user provided auth header matches local token"),[4,(0,$.getTokenForHeaderAuth)("access")]);case 1:return A=T.sent(),[4,(0,$.getTokenForHeaderAuth)("refresh")];case 2:if(_=T.sent(),A!==void 0&&_!==void 0&&g==="Bearer ".concat(A))return(0,F.logDebugMessage)("XHRInterceptor.setRequestHeader: skipping Authorization from user provided headers because it contains our access token"),[2];T.label=3;case 3:return a.push(function(x){x.setRequestHeader(v,g)}),u.push({name:v,value:g}),t.setRequestHeader(v,g),[2]}})})})};var m=void 0;S(n,t,!1);function S(v,g,P){var A,_=["load","loadend","readystatechange"];(0,F.logDebugMessage)("XHRInterceptor.setUpXHR called");for(var T=function(L){(0,F.logDebugMessage)("XHRInterceptor added listener for event ".concat(L)),g.addEventListener(L,function(Z){(0,F.logDebugMessage)("XHRInterceptor got event ".concat(L)),_.includes(L)||U(L,Z)})},x=0,me=$i;x<me.length;x++){var yt=me[x];T(yt)}if(g.onload=function(L){A===void 0&&(A=O(g)),A.then(function(Z){Z&&(v.onload&&v.onload(L),U("load",L))})},g.onreadystatechange=function(L){g.readyState===r.DONE?(A===void 0&&(A=O(g)),A.then(function(Z){Z&&(v.onreadystatechange&&v.onreadystatechange(L),U("readystatechange",L))})):(v.onreadystatechange&&v.onreadystatechange(L),U("readystatechange",L))},g.onloadend=function(L){A===void 0&&(A=O(g)),A.then(function(Z){Z&&(v.onloadend&&v.onloadend(L),U("loadend",L))})},v.getAllResponseHeaders=function(){var L;return s?(L="",s.forEach(function(Z,we){return L+="".concat(we,": ").concat(Z,`\r
`)})):L=g.getAllResponseHeaders(),L+`x-supertokens-xhr-intercepted: true\r
`},v.getResponseHeader=function(L){return L==="x-supertokens-xhr-intercepted"?"true":s?s.get(L):g.getResponseHeader(L)},m===void 0){m=[];for(var Ue in g)Ue in v||m.push(Ue)}for(var Vn=function(L){typeof g[L]=="function"?Object.defineProperty(v,L,{configurable:!0,value:function(){var Z=arguments;return P||a.push(function(we){we[L].apply(we,Z)}),g[L].apply(g,Z)}}):Object.defineProperty(v,L,{configurable:!0,get:function(){return c[L]!==void 0?c[L]:g[L]},set:function(Z){P||a.push(function(we){we[L]=Z}),(0,F.logDebugMessage)("XHRInterceptor.set[".concat(L,"] = ").concat(Z)),g[L]=Z}})},Ne=0,Qe=m;Ne<Qe.length;Ne++){var Ue=Qe[Ne];Vn(Ue)}}function N(v,g){var P=this;if((0,F.logDebugMessage)("XHRInterceptor.send: called"),(0,F.logDebugMessage)("XHRInterceptor.send: Value of doNotDoInterception: "+b),b){(0,F.logDebugMessage)("XHRInterceptor.send: Returning without interception"),o(function(){return v.send(g)});return}(0,F.logDebugMessage)("XHRInterceptor.send: Interception started"),$t.ProcessState.getInstance().addState($t.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),o(function(){return He(P,void 0,void 0,function(){var A,_;return Fe(this,function(T){switch(T.label){case 0:return[4,(0,$.getLocalSessionState)(!0)];case 1:return f=T.sent(),f.status!=="EXISTS"?[3,3]:[4,$.AntiCsrfToken.getToken(f.lastAccessTokenUpdate)];case 2:A=T.sent(),A!==void 0&&((0,F.logDebugMessage)("XHRInterceptor.send: Adding anti-csrf token to request"),v.setRequestHeader("anti-csrf",A)),T.label=3;case 3:return $.default.config.autoAddCredentials&&((0,F.logDebugMessage)("XHRInterceptor.send: Adding credentials include"),n.withCredentials=!0),u.some(function(x){return x.name==="rid"})?(0,F.logDebugMessage)("XHRInterceptor.send: rid header was already there in request"):((0,F.logDebugMessage)("XHRInterceptor.send: Adding rid header: anti-csrf"),v.setRequestHeader("rid","anti-csrf")),_=$.default.config.tokenTransferMethod,u.some(function(x){return x.name==="st-auth-mode"})?(0,F.logDebugMessage)("XHRInterceptor.send: st-auth-mode header was already there in request"):((0,F.logDebugMessage)("XHRInterceptor.send: Adding st-auth-mode header: "+_),v.setRequestHeader("st-auth-mode",_)),[4,Gi(v,u)];case 4:return T.sent(),(0,F.logDebugMessage)("XHRInterceptor.send: Making user's http call"),[2,v.send(g)]}})})})}},XMLHttpRequest.__interceptedBySuperTokens=!0,XMLHttpRequest.__original=r}jt.addInterceptorsToXMLHttpRequest=Vi;function Bi(e){return He(this,void 0,void 0,function(){var r,t,i,o,n;return Fe(this,function(a){switch(a.label){case 0:if(r=e.headers.get("content-type"),t="",i="text",r!==null)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e.text()];case 2:return t=a.sent(),[3,4];case 3:return a.sent(),t="",[3,4];case 4:return[3,9];case 5:return r.includes("application/json")?(i="json",n=(o=JSON).stringify,[4,e.json()]):[3,7];case 6:return t=n.apply(o,[a.sent()]),[3,9];case 7:return r.includes("text/")?[4,e.text()]:[3,9];case 8:t=a.sent(),a.label=9;case 9:return[2,{status:e.status,responseText:t,statusText:e.statusText,responseType:i,headers:e.headers}]}})})}function Gi(e,r){return He(this,void 0,void 0,function(){var t,i;return Fe(this,function(o){switch(o.label){case 0:return(0,F.logDebugMessage)("setAuthorizationHeaderIfRequired: adding existing tokens as header"),[4,(0,$.getTokenForHeaderAuth)("access")];case 1:return t=o.sent(),[4,(0,$.getTokenForHeaderAuth)("refresh")];case 2:return i=o.sent(),t!==void 0&&i!==void 0?r.some(function(n){var a=n.name;return a.toLowerCase()==="authorization"})?(0,F.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):t!==void 0&&((0,F.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),e.setRequestHeader("Authorization","Bearer ".concat(t))):(0,F.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"),[2]}})})}function Wi(e){return He(this,void 0,void 0,function(){var r,t,i,o,n;return Fe(this,function(a){switch(a.label){case 0:return(0,F.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response"),r=e.get("st-refresh-token"),r===null?[3,2]:((0,F.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,(0,$.setToken)("refresh",r)]);case 1:a.sent(),a.label=2;case 2:return t=e.get("st-access-token"),t===null?[3,4]:((0,F.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,(0,$.setToken)("access",t)]);case 3:a.sent(),a.label=4;case 4:return i=e.get("front-token"),i===null?[3,6]:((0,F.logDebugMessage)("saveTokensFromHeaders: Setting sFrontToken: "+i),[4,$.FrontToken.setItem(i)]);case 5:a.sent(),(0,$.updateClockSkewUsingFrontToken)({frontToken:i,responseHeaders:e}),a.label=6;case 6:return o=e.get("anti-csrf"),o===null?[3,9]:[4,(0,$.getLocalSessionState)(!0)];case 7:return n=a.sent(),n.status!=="EXISTS"?[3,9]:((0,F.logDebugMessage)("saveTokensFromHeaders: Setting anti-csrf token"),[4,$.AntiCsrfToken.setItem(n.lastAccessTokenUpdate,o)]);case 8:a.sent(),a.label=9;case 9:return[2]}})})}function Xi(e){return new Headers(e.getAllResponseHeaders().split(`\r
`).map(function(r){var t=r.indexOf(": ");return t===-1?["",""]:[r.slice(0,t),r.slice(t+2)]}).filter(function(r){return r[0].length!==0}))}var Ln=p&&p.__assign||function(){return Ln=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Ln.apply(this,arguments)},Ce=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},Ae=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(Dn,"__esModule",{value:!0});var Re=Ge,Vt=ke,zi=Ee,W=oe,Ji=it,Ki=jt,Bt=te,Nr=ve,Qi=De,Un=100,qr="CLAIM_REFRESH_LOCK";function Yi(e){return{addXMLHttpRequestInterceptor:function(r){(0,W.logDebugMessage)("addXMLHttpRequestInterceptorAndReturnModified: called"),(0,Ki.addInterceptorsToXMLHttpRequest)()},addFetchInterceptorsAndReturnModifiedFetch:function(r){return(0,W.logDebugMessage)("addFetchInterceptorsAndReturnModifiedFetch: called"),function(t,i){return Ce(this,void 0,void 0,function(){return Ae(this,function(o){switch(o.label){case 0:return[4,Re.default.doRequest(function(n){return r.originalFetch(typeof t=="object"&&"clone"in t?t.clone():t,Ln({},n))},i,t)];case 1:return[2,o.sent()]}})})}},addAxiosInterceptors:function(r){if((0,W.logDebugMessage)("addAxiosInterceptors: called"),XMLHttpRequest.__interceptedBySuperTokens){console.warn("Not adding axios interceptor since XMLHttpRequest is already added. This is just a warning."),console.warn("Our axios and XMLHttpRequest interceptors cannot be used at the same time."),console.warn("Since XMLHttpRequest is added automatically and supports axios by default, you can just remove addAxiosInterceptors from your code."),console.warn("If you want to continue using our axios interceptor, you can override addXMLHttpRequestInterceptor with an empty function."),(0,W.logDebugMessage)("addAxiosInterceptors: not adding, because XHR interceptors are already in place");return}for(var t=r.axiosInstance.interceptors.request,i=0;i<t.handlers.length;i++)if(t.handlers[i].fulfilled===Vt.interceptorFunctionRequestFulfilled){(0,W.logDebugMessage)("addAxiosInterceptors: not adding because already added on this instance");return}r.axiosInstance.interceptors.request.use(Vt.interceptorFunctionRequestFulfilled,function(o){return Ce(this,void 0,void 0,function(){return Ae(this,function(n){throw o})})}),r.axiosInstance.interceptors.response.use((0,Vt.responseInterceptor)(r.axiosInstance),(0,Vt.responseErrorInterceptor)(r.axiosInstance))},getUserId:function(r){return Ce(this,void 0,void 0,function(){var t;return Ae(this,function(i){switch(i.label){case 0:return(0,W.logDebugMessage)("getUserId: called"),[4,Re.FrontToken.getTokenInfo()];case 1:if(t=i.sent(),t===void 0)throw new Error("No session exists");return(0,W.logDebugMessage)("getUserId: returning: "+t.uid),[2,t.uid]}})})},getAccessTokenPayloadSecurely:function(r){return Ce(this,void 0,void 0,function(){var t,i;return Ae(this,function(o){switch(o.label){case 0:return(0,W.logDebugMessage)("getAccessTokenPayloadSecurely: called"),[4,Re.FrontToken.getTokenInfo()];case 1:if(t=o.sent(),t===void 0)throw new Error("No session exists");return t.ate<Nr.default.getReferenceOrThrow().dateProvider.now()?((0,W.logDebugMessage)("getAccessTokenPayloadSecurely: access token expired. Refreshing session"),[4,Re.default.attemptRefreshingSession()]):[3,5];case 2:return i=o.sent(),i?[4,this.getAccessTokenPayloadSecurely({userContext:r.userContext})]:[3,4];case 3:return[2,o.sent()];case 4:throw new Error("Could not refresh session");case 5:return(0,W.logDebugMessage)("getAccessTokenPayloadSecurely: returning: "+JSON.stringify(t.up)),[2,t.up]}})})},doesSessionExist:function(r){return Ce(this,void 0,void 0,function(){var t,i,o;return Ae(this,function(n){switch(n.label){case 0:return(0,W.logDebugMessage)("doesSessionExist: called"),[4,Re.FrontToken.getTokenInfo()];case 1:return t=n.sent(),t===void 0?((0,W.logDebugMessage)("doesSessionExist: access token does not exist locally"),[2,!1]):t.ate<Nr.default.getReferenceOrThrow().dateProvider.now()?((0,W.logDebugMessage)("doesSessionExist: access token expired. Refreshing session"),[4,(0,Re.getLocalSessionState)(!1)]):[3,4];case 2:return i=n.sent(),[4,(0,Re.onUnauthorisedResponse)(i)];case 3:return o=n.sent(),[2,o.result==="RETRY"];case 4:return[2,!0]}})})},signOut:function(r){return Ce(this,void 0,void 0,function(){var t,i,o,n;return Ae(this,function(a){switch(a.label){case 0:return(0,W.logDebugMessage)("signOut: called"),[4,this.doesSessionExist(r)];case 1:return a.sent()?((0,W.logDebugMessage)("signOut: Calling refresh pre API hook"),[4,e.preAPIHook({action:"SIGN_OUT",requestInit:{method:"post",headers:{"fdi-version":zi.supported_fdi.join(","),rid:Re.default.rid}},url:Re.default.signOutUrl,userContext:r.userContext})]):((0,W.logDebugMessage)("signOut: exiting early because session does not exist"),(0,W.logDebugMessage)("signOut: firing SIGN_OUT event"),e.onHandleEvent({action:"SIGN_OUT",userContext:r.userContext}),[2]);case 2:return t=a.sent(),(0,W.logDebugMessage)("signOut: Calling API"),[4,fetch(t.url,t.requestInit)];case 3:if(i=a.sent(),(0,W.logDebugMessage)("signOut: API ended"),(0,W.logDebugMessage)("signOut: API responded with status code: "+i.status),i.status===e.sessionExpiredStatusCode)return[2];if(i.status>=300)throw i;return[4,e.postAPIHook({action:"SIGN_OUT",requestInit:t.requestInit,url:t.url,fetchResponse:i.clone(),userContext:r.userContext})];case 4:return a.sent(),[4,i.clone().json()];case 5:if(o=a.sent(),o.status==="GENERAL_ERROR")throw(0,W.logDebugMessage)("doRequest: Throwing general error"),n=o.message===void 0?"No Error Message Provided":o.message,new Ji.STGeneralError(n);return[2]}})})},getInvalidClaimsFromResponse:function(r){return Ce(this,void 0,void 0,function(){var t;return Ae(this,function(i){switch(i.label){case 0:return"body"in r.response?[4,r.response.clone().json()]:[3,2];case 1:return t=i.sent(),[3,3];case 2:typeof r.response.data=="string"?t=JSON.parse(r.response.data):t=r.response.data,i.label=3;case 3:return[2,t.claimValidationErrors]}})})},getGlobalClaimValidators:function(r){return r.claimValidatorsAddedByOtherRecipes},validateClaims:function(r){return Ce(this,void 0,void 0,function(){var t,i,o,n,a,u,b,c,s,l,d,b,f;return Ae(this,function(k){switch(k.label){case 0:i=0,k.label=1;case 1:return++i<Un?[4,Qi.default.getReferenceOrThrow().lockFactory()]:[3,20];case 2:return o=k.sent(),(0,W.logDebugMessage)("validateClaims: trying to acquire claim refresh lock"),[4,o.acquireLock(qr)];case 3:if(n=k.sent(),!n)return[3,18];k.label=4;case 4:return k.trys.push([4,,15,17]),[4,this.getAccessTokenPayloadSecurely({userContext:r.userContext})];case 5:t=k.sent(),(0,W.logDebugMessage)("validateClaims: claim refresh lock acquired"),a=0,u=r.claimValidators,k.label=6;case 6:return a<u.length?(b=u[a],[4,b.shouldRefresh(t,r.userContext)]):[3,14];case 7:if(!k.sent())return[3,13];k.label=8;case 8:return k.trys.push([8,10,,11]),[4,b.refresh(r.userContext)];case 9:return k.sent(),[3,11];case 10:return c=k.sent(),console.error("Encountered an error while refreshing validator ".concat(b.id),c),[3,11];case 11:return[4,this.getAccessTokenPayloadSecurely({userContext:r.userContext})];case 12:t=k.sent(),k.label=13;case 13:return a++,[3,6];case 14:return[3,17];case 15:return(0,W.logDebugMessage)("validateClaims: releasing claim refresh lock"),[4,o.releaseLock(qr)];case 16:return k.sent(),[7];case 17:return[3,20];case 18:(0,W.logDebugMessage)("validateClaims: Retrying refresh lock ".concat(i,"/").concat(Un)),k.label=19;case 19:return[3,1];case 20:return i!==Un?[3,22]:((0,W.logDebugMessage)("validateClaims: ran out of retries while trying to acquire claim refresh lock"),[4,this.getAccessTokenPayloadSecurely({userContext:r.userContext})]);case 21:t=k.sent(),k.label=22;case 22:s=[],l=0,d=r.claimValidators,k.label=23;case 23:return l<d.length?(b=d[l],[4,b.validate(t,r.userContext)]):[3,26];case 24:f=k.sent(),f.isValid||s.push({id:b.id,reason:f.reason}),k.label=25;case 25:return l++,[3,23];case 26:return[2,s]}})})},shouldDoInterceptionBasedOnUrl:function(r,t,i){if((0,W.logDebugMessage)("shouldDoInterceptionBasedOnUrl: toCheckUrl: "+r+" apiDomain: "+t+" sessionTokenBackendDomain: "+i),r.includes("superTokensDoNotDoInterception"))return!1;r=(0,Bt.normaliseURLDomainOrThrowError)(r);var o=new URL(r),n=o.hostname,a=!1;if(t!==""){t=(0,Bt.normaliseURLDomainOrThrowError)(t);var u=new URL(t);a=n===u.hostname}if(i===void 0||a)return a;var c=(0,Bt.normaliseSessionScopeOrThrowError)(i);return(0,Bt.matchesDomainOrSubdomain)(n,c)},calculateClockSkewInMillis:function(r){var t=r.accessTokenPayload;(0,W.logDebugMessage)("calculateClockSkewInMillis: called");var i=t==null?void 0:t.iat;if(i===void 0||typeof i!="number")return(0,W.logDebugMessage)("calculateClockSkewInMillis: payload iat is undefined or not a number. This may happen due to an unsupported backend sdk. Returning 0"),0;var o=i*1e3,n=o-Date.now();return(0,W.logDebugMessage)("calculateClockSkewInMillis: returning "+n),n}}}Dn.default=Yi;var Le={},Gt={},Wt=p&&p.__assign||function(){return Wt=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Wt.apply(this,arguments)};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.getProxyObject=void 0;function Zi(e){for(var r=Wt(Wt({},e),{_call:function(u,c){throw new Error("This function should only be called through the recipe object")}}),t=Object.keys(r),i=function(u){u!=="_call"&&(r[u]=function(){for(var c=[],s=0;s<arguments.length;s++)c[s]=arguments[s];return this._call(u,c)})},o=0,n=t;o<n.length;o++){var a=n[o];i(a)}return r}Gt.getProxyObject=Zi,Object.defineProperty(Le,"__esModule",{value:!0}),Le.OverrideableBuilder=void 0;var eo=Gt,jr=function(){function e(r){this.layers=[r],this.proxies=[]}return e.prototype.override=function(r){for(var t=(0,eo.getProxyObject)(this.layers[0]),i=r(t,this),o=0,n=Object.keys(this.layers[0]);o<n.length;o++){var a=n[o];i[a]===t[a]||a==="_call"?delete i[a]:i[a]===void 0&&(i[a]=null)}return this.layers.push(i),this.proxies.push(t),this},e.prototype.build=function(){var r=this;if(this.result)return this.result;this.result={};for(var t=0,i=this.layers;t<i.length;t++)for(var o=i[t],n=0,a=Object.keys(o);n<a.length;n++){var u=a[n],c=o[u];c!==void 0&&(c===null?this.result[u]=void 0:typeof c=="function"?this.result[u]=c.bind(this.result):this.result[u]=c)}for(var s=function(b){var f=l.proxies[b];f._call=function(k,H){for(var U=b;U>=0;--U){var M=r.layers[U][k];if(M!=null)return M.bind(r.result).apply(void 0,H)}}},l=this,d=0;d<this.proxies.length;++d)s(d);return this.result},e}();Le.OverrideableBuilder=jr,Le.default=jr;var ot={},$r;function Vr(){if($r)return ot;$r=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.PrimitiveClaim=void 0;var e=ve,r=function(){function t(i){var o=this;this.validators={hasValue:function(n,a,u){a===void 0&&(a=o.defaultMaxAgeInSeconds);var c=e.default.getReferenceOrThrow().dateProvider;return{id:u!==void 0?u:o.id,refresh:function(s){return o.refresh(s)},shouldRefresh:function(s,l){if(a!==void 0&&a<c.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(c.getThresholdInSeconds()));return o.getValueFromPayload(s,l)===void 0||a!==void 0&&s[o.id].t<c.now()-a*1e3},validate:function(s,l){var d=o.getValueFromPayload(s,l);if(d===void 0)return{isValid:!1,reason:{message:"value does not exist",expectedValue:n,actualValue:d}};var b=(c.now()-o.getLastFetchedTime(s,l))/1e3;return a!==void 0&&b>a?{isValid:!1,reason:{message:"expired",ageInSeconds:b,maxAgeInSeconds:a}}:d!==n?{isValid:!1,reason:{message:"wrong value",expectedValue:n,actualValue:d}}:{isValid:!0}}}}},this.id=i.id,this.refresh=i.refresh,this.defaultMaxAgeInSeconds=i.defaultMaxAgeInSeconds}return t.prototype.getValueFromPayload=function(i,o){return i[this.id]!==void 0?i[this.id].v:void 0},t.prototype.getLastFetchedTime=function(i,o){return i[this.id]!==void 0?i[this.id].t:void 0},t}();return ot.PrimitiveClaim=r,ot}var at={},Br;function to(){if(Br)return at;Br=1;var e=p&&p.__awaiter||function(o,n,a,u){function c(s){return s instanceof a?s:new a(function(l){l(s)})}return new(a||(a=Promise))(function(s,l){function d(k){try{f(u.next(k))}catch(H){l(H)}}function b(k){try{f(u.throw(k))}catch(H){l(H)}}function f(k){k.done?s(k.value):c(k.value).then(d,b)}f((u=u.apply(o,n||[])).next())})},r=p&&p.__generator||function(o,n){var a={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},u,c,s,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(f){return function(k){return b([f,k])}}function b(f){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,c&&(s=f[0]&2?c.return:f[0]?c.throw||((s=c.return)&&s.call(c),0):c.next)&&!(s=s.call(c,f[1])).done)return s;switch(c=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return a.label++,{value:f[1],done:!1};case 5:a.label++,c=f[1],f=[0];continue;case 7:f=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){a=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){a.label=f[1];break}if(f[0]===6&&a.label<s[1]){a.label=s[1],s=f;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(f);break}s[2]&&a.ops.pop(),a.trys.pop();continue}f=n.call(o,a)}catch(k){f=[6,k],c=0}finally{u=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}};Object.defineProperty(at,"__esModule",{value:!0}),at.PrimitiveArrayClaim=void 0;var t=ve,i=function(){function o(n){var a=this;this.validators={includes:function(u,c,s){c===void 0&&(c=a.defaultMaxAgeInSeconds);var l=t.default.getReferenceOrThrow().dateProvider;return{id:s!==void 0?s:a.id,refresh:function(d){return a.refresh(d)},shouldRefresh:function(d,b){if(c!==void 0&&c<l.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(l.getThresholdInSeconds()));return a.getValueFromPayload(d,b)===void 0||c!==void 0&&d[a.id].t<l.now()-c*1e3},validate:function(d,b){return e(a,void 0,void 0,function(){var f,k;return r(this,function(H){return f=this.getValueFromPayload(d,b),f===void 0?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:u,actualValue:f}}]:(k=(l.now()-this.getLastFetchedTime(d,b))/1e3,c!==void 0&&k>c?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:k,maxAgeInSeconds:c}}]:f.includes(u)?[2,{isValid:!0}]:[2,{isValid:!1,reason:{message:"wrong value",expectedToInclude:u,actualValue:f}}])})})}}},excludes:function(u,c,s){c===void 0&&(c=a.defaultMaxAgeInSeconds);var l=t.default.getReferenceOrThrow().dateProvider;return{id:s!==void 0?s:a.id,refresh:function(d){return a.refresh(d)},shouldRefresh:function(d,b){if(c!==void 0&&c<l.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(l.getThresholdInSeconds()));return a.getValueFromPayload(d,b)===void 0||c!==void 0&&d[a.id].t<l.now()-c*1e3},validate:function(d,b){return e(a,void 0,void 0,function(){var f,k;return r(this,function(H){return f=this.getValueFromPayload(d,b),f===void 0?[2,{isValid:!1,reason:{message:"value does not exist",expectedToNotInclude:u,actualValue:f}}]:(k=(l.now()-this.getLastFetchedTime(d,b))/1e3,c!==void 0&&k>c?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:k,maxAgeInSeconds:c}}]:f.includes(u)?[2,{isValid:!1,reason:{message:"wrong value",expectedToNotInclude:u,actualValue:f}}]:[2,{isValid:!0}])})})}}},includesAll:function(u,c,s){c===void 0&&(c=a.defaultMaxAgeInSeconds);var l=t.default.getReferenceOrThrow().dateProvider;return{id:s!==void 0?s:a.id,refresh:function(d){return a.refresh(d)},shouldRefresh:function(d,b){if(c!==void 0&&c<l.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(l.getThresholdInSeconds()));return a.getValueFromPayload(d,b)===void 0||c!==void 0&&d[a.id].t<l.now()-c*1e3},validate:function(d,b){return e(a,void 0,void 0,function(){var f,k,H,U;return r(this,function(M){return f=this.getValueFromPayload(d,b),f===void 0?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:u,actualValue:f}}]:(k=(l.now()-this.getLastFetchedTime(d,b))/1e3,c!==void 0&&k>c?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:k,maxAgeInSeconds:c}}]:(H=new Set(f),U=u.every(function(O){return H.has(O)}),[2,U?{isValid:U}:{isValid:U,reason:{message:"wrong value",expectedToInclude:u,actualValue:f}}]))})})}}},includesAny:function(u,c,s){c===void 0&&(c=a.defaultMaxAgeInSeconds);var l=t.default.getReferenceOrThrow().dateProvider;return{id:s!==void 0?s:a.id,refresh:function(d){return a.refresh(d)},shouldRefresh:function(d,b){if(c!==void 0&&c<l.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(l.getThresholdInSeconds()));return a.getValueFromPayload(d,b)===void 0||c!==void 0&&d[a.id].t<l.now()-c*1e3},validate:function(d,b){return e(a,void 0,void 0,function(){var f,k,H,U;return r(this,function(M){return f=this.getValueFromPayload(d,b),f===void 0?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:u,actualValue:f}}]:(k=(l.now()-this.getLastFetchedTime(d,b))/1e3,c!==void 0&&k>c?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:k,maxAgeInSeconds:c}}]:(H=new Set(f),U=u.some(function(O){return H.has(O)}),[2,U?{isValid:U}:{isValid:U,reason:{message:"wrong value",expectedToIncludeAtLeastOneOf:u,actualValue:f}}]))})})}}},excludesAll:function(u,c,s){c===void 0&&(c=a.defaultMaxAgeInSeconds);var l=t.default.getReferenceOrThrow().dateProvider;return{id:s!==void 0?s:a.id,refresh:function(d){return a.refresh(d)},shouldRefresh:function(d,b){if(c!==void 0&&c<l.getThresholdInSeconds())throw new Error("maxAgeInSeconds must be greater than or equal to the DateProvider threshold value -> ".concat(l.getThresholdInSeconds()));return a.getValueFromPayload(d,b)===void 0||c!==void 0&&d[a.id].t<l.now()-c*1e3},validate:function(d,b){return e(a,void 0,void 0,function(){var f,k,H,U;return r(this,function(M){return f=this.getValueFromPayload(d,b),f===void 0?[2,{isValid:!1,reason:{message:"value does not exist",expectedToNotInclude:u,actualValue:f}}]:(k=(l.now()-this.getLastFetchedTime(d,b))/1e3,c!==void 0&&k>c?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:k,maxAgeInSeconds:c}}]:(H=new Set(f),U=u.every(function(O){return!H.has(O)}),[2,U?{isValid:U}:{isValid:U,reason:{message:"wrong value",expectedToNotInclude:u,actualValue:f}}]))})})}}}},this.id=n.id,this.refresh=n.refresh,this.defaultMaxAgeInSeconds=n.defaultMaxAgeInSeconds}return o.prototype.getValueFromPayload=function(n,a){return n[this.id]!==void 0?n[this.id].v:void 0},o.prototype.getLastFetchedTime=function(n,a){return n[this.id]!==void 0?n[this.id].t:void 0},o}();return at.PrimitiveArrayClaim=i,at}var ut={},Gr;function no(){if(Gr)return ut;Gr=1;var e=p&&p.__extends||function(){var o=function(n,a){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,c){u.__proto__=c}||function(u,c){for(var s in c)Object.prototype.hasOwnProperty.call(c,s)&&(u[s]=c[s])},o(n,a)};return function(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");o(n,a);function u(){this.constructor=n}n.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}(),r=p&&p.__assign||function(){return r=Object.assign||function(o){for(var n,a=1,u=arguments.length;a<u;a++){n=arguments[a];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(o[c]=n[c])}return o},r.apply(this,arguments)};Object.defineProperty(ut,"__esModule",{value:!0}),ut.BooleanClaim=void 0;var t=Vr(),i=function(o){e(n,o);function n(a){var u=o.call(this,a)||this;return u.validators=r(r({},u.validators),{isTrue:function(c){return u.validators.hasValue(!0,c)},isFalse:function(c){return u.validators.hasValue(!1,c)}}),u}return n}(t.PrimitiveClaim);return ut.BooleanClaim=i,ut}(function(e){var r=p&&p.__awaiter||function(M,O,m,S){function N(v){return v instanceof m?v:new m(function(g){g(v)})}return new(m||(m=Promise))(function(v,g){function P(T){try{_(S.next(T))}catch(x){g(x)}}function A(T){try{_(S.throw(T))}catch(x){g(x)}}function _(T){T.done?v(T.value):N(T.value).then(P,A)}_((S=S.apply(M,O||[])).next())})},t=p&&p.__generator||function(M,O){var m={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},S,N,v,g;return g={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function P(_){return function(T){return A([_,T])}}function A(_){if(S)throw new TypeError("Generator is already executing.");for(;m;)try{if(S=1,N&&(v=_[0]&2?N.return:_[0]?N.throw||((v=N.return)&&v.call(N),0):N.next)&&!(v=v.call(N,_[1])).done)return v;switch(N=0,v&&(_=[_[0]&2,v.value]),_[0]){case 0:case 1:v=_;break;case 4:return m.label++,{value:_[1],done:!1};case 5:m.label++,N=_[1],_=[0];continue;case 7:_=m.ops.pop(),m.trys.pop();continue;default:if(v=m.trys,!(v=v.length>0&&v[v.length-1])&&(_[0]===6||_[0]===2)){m=0;continue}if(_[0]===3&&(!v||_[1]>v[0]&&_[1]<v[3])){m.label=_[1];break}if(_[0]===6&&m.label<v[1]){m.label=v[1],v=_;break}if(v&&m.label<v[2]){m.label=v[2],m.ops.push(_);break}v[2]&&m.ops.pop(),m.trys.pop();continue}_=O.call(M,m)}catch(T){_=[6,T],N=0}finally{S=v=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanClaim=e.PrimitiveArrayClaim=e.PrimitiveClaim=e.getInvalidClaimsFromResponse=e.getClaimValue=e.validateClaims=e.signOut=e.addAxiosInterceptors=e.doesSessionExist=e.attemptRefreshingSession=e.getAccessToken=e.getAccessTokenPayloadSecurely=e.getUserId=e.init=void 0;var i=Ge,o=Dn,n=Le,a=te,u=Oe,c=ie,s=De,l=Xe,d=oe,b=ve,f=function(){function M(){}M.init=function(m){u.default.init(m.cookieHandler),c.default.init(m.windowHandler),b.default.init(m.dateProvider),s.default.init(m.lockFactory,c.default.getReferenceOrThrow().windowHandler.localStorage);var S=(0,a.validateAndNormaliseInputOrThrowError)(m);m.enableDebugLogs!==void 0&&m.enableDebugLogs&&(0,d.enableLogging)();var N=new n.default((0,o.default)({onHandleEvent:S.onHandleEvent,preAPIHook:S.preAPIHook,postAPIHook:S.postAPIHook,sessionExpiredStatusCode:S.sessionExpiredStatusCode})).override(S.override.functions).build();i.default.init(S,N),M.axiosInterceptorQueue.forEach(function(v){v()}),M.axiosInterceptorQueue=[]},M.getUserId=function(m){return i.default.recipeImpl.getUserId({userContext:(0,a.getNormalisedUserContext)(m===void 0?void 0:m.userContext)})},M.getAccessTokenPayloadSecurely=function(m){return r(this,void 0,void 0,function(){return t(this,function(S){return[2,i.default.recipeImpl.getAccessTokenPayloadSecurely({userContext:(0,a.getNormalisedUserContext)(m===void 0?void 0:m.userContext)})]})})};var O;return O=M,M.axiosInterceptorQueue=[],M.attemptRefreshingSession=function(){return r(void 0,void 0,void 0,function(){return t(O,function(m){return[2,i.default.attemptRefreshingSession()]})})},M.doesSessionExist=function(m){return i.default.recipeImpl.doesSessionExist({userContext:(0,a.getNormalisedUserContext)(m===void 0?void 0:m.userContext)})},M.addAxiosInterceptors=function(m,S){i.default.initCalled?i.default.recipeImpl.addAxiosInterceptors({axiosInstance:m,userContext:(0,a.getNormalisedUserContext)(S)}):M.axiosInterceptorQueue.push(function(){i.default.recipeImpl.addAxiosInterceptors({axiosInstance:m,userContext:(0,a.getNormalisedUserContext)(S)})})},M.signOut=function(m){return i.default.recipeImpl.signOut({userContext:(0,a.getNormalisedUserContext)(m===void 0?void 0:m.userContext)})},M.getInvalidClaimsFromResponse=function(m){return r(this,void 0,void 0,function(){return t(this,function(S){return[2,i.default.recipeImpl.getInvalidClaimsFromResponse({response:m.response,userContext:(0,a.getNormalisedUserContext)(m.userContext)})]})})},M.getClaimValue=function(m){return r(this,void 0,void 0,function(){var S,N;return t(this,function(v){switch(v.label){case 0:return S=(0,a.getNormalisedUserContext)(m===void 0?void 0:m.userContext),[4,M.getAccessTokenPayloadSecurely({userContext:S})];case 1:return N=v.sent(),[2,m.claim.getValueFromPayload(N,S)]}})})},M.validateClaims=function(m,S){var N=(0,a.getNormalisedUserContext)(S),v=l.SessionClaimValidatorStore.getClaimValidatorsAddedByOtherRecipes(),g=i.default.recipeImpl.getGlobalClaimValidators({claimValidatorsAddedByOtherRecipes:v,userContext:N}),P=m!==void 0?m(g,N):g;return P.length===0?[]:i.default.recipeImpl.validateClaims({claimValidators:P,userContext:(0,a.getNormalisedUserContext)(S)})},M.getAccessToken=function(m){return r(void 0,void 0,void 0,function(){return t(O,function(S){switch(S.label){case 0:return[4,i.default.recipeImpl.doesSessionExist({userContext:(0,a.getNormalisedUserContext)(m===void 0?void 0:m.userContext)})];case 1:return S.sent()?[2,(0,i.getTokenForHeaderAuth)("access")]:[2,void 0]}})})},M}();e.default=f,e.init=f.init,e.getUserId=f.getUserId,e.getAccessTokenPayloadSecurely=f.getAccessTokenPayloadSecurely,e.getAccessToken=f.getAccessToken,e.attemptRefreshingSession=f.attemptRefreshingSession,e.doesSessionExist=f.doesSessionExist,e.addAxiosInterceptors=f.addAxiosInterceptors,e.signOut=f.signOut,e.validateClaims=f.validateClaims,e.getClaimValue=f.getClaimValue,e.getInvalidClaimsFromResponse=f.getInvalidClaimsFromResponse;var k=Vr();Object.defineProperty(e,"PrimitiveClaim",{enumerable:!0,get:function(){return k.PrimitiveClaim}});var H=to();Object.defineProperty(e,"PrimitiveArrayClaim",{enumerable:!0,get:function(){return H.PrimitiveArrayClaim}});var U=no();Object.defineProperty(e,"BooleanClaim",{enumerable:!0,get:function(){return U.BooleanClaim}})})(Fr),function(e){function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}e.__esModule=!0,r(Fr)}(On);var Xt={};Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.EMAILVERIFICATION_CLAIM_ID=void 0,Xt.EMAILVERIFICATION_CLAIM_ID="st-ev";var ro=p&&p.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function i(){this.constructor=r}r.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ae=p&&p.__assign||function(){return ae=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},ae.apply(this,arguments)},zt=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},Jt=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Wr=p&&p.__spreadArray||function(e,r,t){if(t||arguments.length===2)for(var i=0,o=r.length,n;i<o;i++)(n||!(i in r))&&(n||(n=Array.prototype.slice.call(r,0,i)),n[i]=r[i]);return e.concat(n||Array.prototype.slice.call(r))};Object.defineProperty(ze,"__esModule",{value:!0}),ze.Recipe=void 0;var so=Ut,ce=On,Xr=G,io=Xt,zr=[io.EMAILVERIFICATION_CLAIM_ID],Jr=function(e){ro(r,e);function r(t){var i=e.call(this,t)||this;return i.getUserId=function(o){return ce.default.getUserId({userContext:o.userContext})},i.getAccessToken=function(o){return zt(i,void 0,void 0,function(){return Jt(this,function(n){return[2,ce.default.getAccessToken({userContext:o.userContext})]})})},i.getAccessTokenPayloadSecurely=function(o){return zt(i,void 0,void 0,function(){return Jt(this,function(n){return[2,ce.default.getAccessTokenPayloadSecurely({userContext:o.userContext})]})})},i.doesSessionExist=function(o){return ce.default.doesSessionExist({userContext:o.userContext})},i.signOut=function(o){return ce.default.signOut({userContext:o.userContext})},i.attemptRefreshingSession=function(){return zt(i,void 0,void 0,function(){return Jt(this,function(o){return[2,ce.default.attemptRefreshingSession()]})})},i.validateClaims=function(o){return ce.default.validateClaims(o.overrideGlobalClaimValidators,o.userContext)},ce.default.init(ae(ae({},t),{override:{functions:function(o,n){var a;return n.override(function(u){return ae(ae({},u),{getGlobalClaimValidators:function(c){var s=u.getGlobalClaimValidators(c);return Wr(Wr([],s.filter(function(l){return zr.includes(l.id)}),!0),s.filter(function(l){return!zr.includes(l.id)}),!0)}})}),!((a=t.override)===null||a===void 0)&&a.functions&&n.override(t.override.functions),o}},preAPIHook:function(o){return zt(i,void 0,void 0,function(){var n,a;return Jt(this,function(u){return n=new Headers(o.requestInit.headers),n.set("rid",t.recipeId),a=ae(ae({},o),{requestInit:ae(ae({},o.requestInit),{headers:n})}),t.preAPIHook===void 0?[2,a]:[2,t.preAPIHook(o)]})})},apiDomain:t.appInfo.apiDomain.getAsStringDangerous(),apiBasePath:t.appInfo.apiBasePath.getAsStringDangerous()})),i}return r.init=function(t){return function(i,o,n){return r.instance=new r(ae(ae({},t),{appInfo:i,recipeId:r.RECIPE_ID,enableDebugLogs:n})),r.instance}},r.prototype.getClaimValue=function(t){return ce.default.getClaimValue(t)},r.prototype.getInvalidClaimsFromResponse=function(t){return ce.default.getInvalidClaimsFromResponse(t)},r.addAxiosInterceptors=function(t,i){return ce.default.addAxiosInterceptors(t,i)},r.getInstanceOrThrow=function(){if(r.instance===void 0){var t="No instance of Session found. Ensure that the 'Session.init' method is called within the 'SuperTokens.init' recipeList.";throw t=(0,Xr.checkForSSRErrorAndAppendIfNeeded)(t),Error(t)}return r.instance},r.reset=function(){(0,Xr.isTest)()&&(r.instance=void 0)},r.RECIPE_ID="session",r}(so.default);ze.Recipe=Jr,ze.default=Jr,function(e){var r=p&&p.__awaiter||function(O,m,S,N){function v(g){return g instanceof S?g:new S(function(P){P(g)})}return new(S||(S=Promise))(function(g,P){function A(x){try{T(N.next(x))}catch(me){P(me)}}function _(x){try{T(N.throw(x))}catch(me){P(me)}}function T(x){x.done?g(x.value):v(x.value).then(A,_)}T((N=N.apply(O,m||[])).next())})},t=p&&p.__generator||function(O,m){var S={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},N,v,g,P;return P={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function A(T){return function(x){return _([T,x])}}function _(T){if(N)throw new TypeError("Generator is already executing.");for(;S;)try{if(N=1,v&&(g=T[0]&2?v.return:T[0]?v.throw||((g=v.return)&&g.call(v),0):v.next)&&!(g=g.call(v,T[1])).done)return g;switch(v=0,g&&(T=[T[0]&2,g.value]),T[0]){case 0:case 1:g=T;break;case 4:return S.label++,{value:T[1],done:!1};case 5:S.label++,v=T[1],T=[0];continue;case 7:T=S.ops.pop(),S.trys.pop();continue;default:if(g=S.trys,!(g=g.length>0&&g[g.length-1])&&(T[0]===6||T[0]===2)){S=0;continue}if(T[0]===3&&(!g||T[1]>g[0]&&T[1]<g[3])){S.label=T[1];break}if(T[0]===6&&S.label<g[1]){S.label=g[1],g=T;break}if(g&&S.label<g[2]){S.label=g[2],S.ops.push(T);break}g[2]&&S.ops.pop(),S.trys.pop();continue}T=m.call(O,S)}catch(x){T=[6,x],v=0}finally{N=g=0}if(T[0]&5)throw T[1];return{value:T[0]?T[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.getInvalidClaimsFromResponse=e.getClaimValue=e.validateClaims=e.signOut=e.addAxiosInterceptors=e.doesSessionExist=e.attemptRefreshingSession=e.getAccessToken=e.getAccessTokenPayloadSecurely=e.getUserId=e.init=e.BooleanClaim=e.PrimitiveArrayClaim=e.PrimitiveClaim=void 0;var i=G,o=ze,n=function(){function O(){}return O.init=function(m){return o.default.init(m)},O.getUserId=function(m){return o.default.getInstanceOrThrow().getUserId({userContext:(0,i.getNormalisedUserContext)(m==null?void 0:m.userContext)})},O.getAccessToken=function(m){return o.default.getInstanceOrThrow().getAccessToken({userContext:(0,i.getNormalisedUserContext)(m==null?void 0:m.userContext)})},O.getAccessTokenPayloadSecurely=function(m){return r(this,void 0,void 0,function(){return t(this,function(S){return[2,o.default.getInstanceOrThrow().getAccessTokenPayloadSecurely({userContext:(0,i.getNormalisedUserContext)(m==null?void 0:m.userContext)})]})})},O.attemptRefreshingSession=function(){return r(this,void 0,void 0,function(){return t(this,function(m){return[2,o.default.getInstanceOrThrow().attemptRefreshingSession()]})})},O.doesSessionExist=function(m){return o.default.getInstanceOrThrow().doesSessionExist({userContext:(0,i.getNormalisedUserContext)(m==null?void 0:m.userContext)})},O.addAxiosInterceptors=function(m,S){return o.default.addAxiosInterceptors(m,(0,i.getNormalisedUserContext)(S))},O.signOut=function(m){return o.default.getInstanceOrThrow().signOut({userContext:(0,i.getNormalisedUserContext)(m==null?void 0:m.userContext)})},O.getClaimValue=function(m){return o.default.getInstanceOrThrow().getClaimValue({claim:m.claim,userContext:(0,i.getNormalisedUserContext)(m==null?void 0:m.userContext)})},O.validateClaims=function(m){return o.default.getInstanceOrThrow().validateClaims({overrideGlobalClaimValidators:m==null?void 0:m.overrideGlobalClaimValidators,userContext:(0,i.getNormalisedUserContext)(m==null?void 0:m.userContext)})},O.getInvalidClaimsFromResponse=function(m){return o.default.getInstanceOrThrow().getInvalidClaimsFromResponse({response:m.response,userContext:(0,i.getNormalisedUserContext)(m==null?void 0:m.userContext)})},O}();e.default=n;var a=n.init;e.init=a;var u=n.getUserId;e.getUserId=u;var c=n.getAccessTokenPayloadSecurely;e.getAccessTokenPayloadSecurely=c;var s=n.getAccessToken;e.getAccessToken=s;var l=n.attemptRefreshingSession;e.attemptRefreshingSession=l;var d=n.doesSessionExist;e.doesSessionExist=d;var b=n.addAxiosInterceptors;e.addAxiosInterceptors=b;var f=n.signOut;e.signOut=f;var k=n.validateClaims;e.validateClaims=k;var H=n.getClaimValue;e.getClaimValue=H;var U=n.getInvalidClaimsFromResponse;e.getInvalidClaimsFromResponse=U;var M=On;Object.defineProperty(e,"PrimitiveClaim",{enumerable:!0,get:function(){return M.PrimitiveClaim}}),Object.defineProperty(e,"PrimitiveArrayClaim",{enumerable:!0,get:function(){return M.PrimitiveArrayClaim}}),Object.defineProperty(e,"BooleanClaim",{enumerable:!0,get:function(){return M.BooleanClaim}})}(gr),function(e){function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}e.__esModule=!0,r(gr)}(hr);const Kt=vn(hr);var Kr={},lt={},Nn={},Qr={},Yr={};(function(e){function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}e.__esModule=!0,r(Oe)})(Yr),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CookieHandlerReference=void 0;var r=Yr;Object.defineProperty(e,"CookieHandlerReference",{enumerable:!0,get:function(){return r.CookieHandlerReference}})}(Qr);var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.PostSuperTokensInitCallbacks=void 0;var oo=function(){function e(){}return e.addPostInitCallback=function(r){e.postInitCallbacks.push(r)},e.runPostInitCallbacks=function(){for(var r=0,t=e.postInitCallbacks;r<t.length;r++){var i=t[r];i()}},e.postInitCallbacks=[],e}();Qt.PostSuperTokensInitCallbacks=oo;var Je={},Yt={},ct={},Zt={},Zr=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},es=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.normaliseRecipeModuleConfig=void 0;function ao(e){var r=this,t=e.preAPIHook;t===void 0&&(t=function(o){return Zr(r,void 0,void 0,function(){return es(this,function(n){return[2,o]})})});var i=e.postAPIHook;return i===void 0&&(i=function(){return Zr(r,void 0,void 0,function(){return es(this,function(o){return[2]})})}),{recipeId:e.recipeId,appInfo:e.appInfo,clientType:e.clientType,preAPIHook:t,postAPIHook:i}}Zt.normaliseRecipeModuleConfig=ao,Object.defineProperty(ct,"__esModule",{value:!0}),ct.normaliseAuthRecipe=void 0;var uo=Zt;function lo(e){return(0,uo.normaliseRecipeModuleConfig)(e)}ct.normaliseAuthRecipe=lo;var dt=p&&p.__assign||function(){return dt=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},dt.apply(this,arguments)};Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.normaliseUserInput=void 0;var co=ct;function fo(e){var r=dt({functions:function(t){return t}},e.override);return dt(dt({},(0,co.normaliseAuthRecipe)(e)),{override:r})}Yt.normaliseUserInput=fo;var ft={},en={},Ke={};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.supported_fdi=Ke.package_version=void 0,Ke.package_version="0.12.0",Ke.supported_fdi=["2.0","3.0"];var qn={},ts={};(function(e){function r(i){for(var o in i)e.hasOwnProperty(o)||(e[o]=i[o])}e.__esModule=!0;let t=it;t.default!==void 0?r(t):r({default:t,...t})})(ts),Object.defineProperty(qn,"__esModule",{value:!0});var ho=ts;qn.default=ho.STGeneralError;var se=p&&p.__assign||function(){return se=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},se.apply(this,arguments)},Ie=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},Se=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(en,"__esModule",{value:!0});var go=Ot,vo=Ke,po=qn,mo=function(){function e(t,i){var o=this;this.recipeId=t,this.appInfo=i,this.get=function(n,a,u,c,s,l){return Ie(o,void 0,void 0,function(){var d,b;return Se(this,function(f){switch(f.label){case 0:return[4,this.fetch(this.getFullUrl(n,a,c),se({method:"GET"},u),s,l)];case 1:return d=f.sent(),[4,this.getResponseJsonOrThrowGeneralError(d)];case 2:return b=f.sent(),[2,{jsonBody:b,fetchResponse:d}]}})})},this.post=function(n,a,u,c,s){return Ie(o,void 0,void 0,function(){var l,d;return Se(this,function(b){switch(b.label){case 0:if(u.body===void 0)throw new Error("Post request must have a body");return[4,this.fetch(this.getFullUrl(n,a),se({method:"POST"},u),c,s)];case 1:return l=b.sent(),[4,this.getResponseJsonOrThrowGeneralError(l)];case 2:return d=b.sent(),[2,{jsonBody:d,fetchResponse:l}]}})})},this.delete=function(n,a,u,c,s){return Ie(o,void 0,void 0,function(){var l,d;return Se(this,function(b){switch(b.label){case 0:return[4,this.fetch(this.getFullUrl(n,a),se({method:"DELETE"},u),c,s)];case 1:return l=b.sent(),[4,this.getResponseJsonOrThrowGeneralError(l)];case 2:return d=b.sent(),[2,{jsonBody:d,fetchResponse:l}]}})})},this.put=function(n,a,u,c,s){return Ie(o,void 0,void 0,function(){var l,d;return Se(this,function(b){switch(b.label){case 0:return[4,this.fetch(this.getFullUrl(n,a),se({method:"PUT"},u),c,s)];case 1:return l=b.sent(),[4,this.getResponseJsonOrThrowGeneralError(l)];case 2:return d=b.sent(),[2,{jsonBody:d,fetchResponse:l}]}})})},this.fetch=function(n,a,u,c){return Ie(o,void 0,void 0,function(){var s,l,d,b,f,k;return Se(this,function(H){switch(H.label){case 0:return a===void 0?s={}:s=a.headers,[4,this.callPreAPIHook({preAPIHook:u,url:n,requestInit:se(se({},a),{headers:se(se({},s),{"fdi-version":vo.supported_fdi.join(","),"Content-Type":"application/json",rid:this.recipeId})})})];case 1:return l=H.sent(),d=l.requestInit,b=l.url,[4,fetch(b,d)];case 2:if(f=H.sent(),f.status>=300)throw f;return c===void 0?[3,4]:(k=f.clone(),[4,c({requestInit:d,url:n,fetchResponse:k})]);case 3:H.sent(),H.label=4;case 4:return[2,f]}})})},this.callPreAPIHook=function(n){return Ie(o,void 0,void 0,function(){var a;return Se(this,function(u){switch(u.label){case 0:return n.preAPIHook===void 0?[2,{url:n.url,requestInit:n.requestInit}]:[4,n.preAPIHook({url:n.url,requestInit:n.requestInit})];case 1:return a=u.sent(),[2,a]}})})},this.getFullUrl=function(n,a,u){var c=o.appInfo.apiBasePath.getAsStringDangerous();n!==void 0&&n!=="public"&&(c="".concat(c,"/").concat(n));var s=new go.default(a),l="".concat(o.appInfo.apiDomain.getAsStringDangerous()).concat(c).concat(s.getAsStringDangerous());return u===void 0?l:l+"?"+new URLSearchParams(u)},this.getResponseJsonOrThrowGeneralError=function(n){return Ie(o,void 0,void 0,function(){var a,u;return Se(this,function(c){switch(c.label){case 0:return[4,n.clone().json()];case 1:if(a=c.sent(),a.status==="GENERAL_ERROR")throw u=a.message===void 0?"No Error Message Provided":a.message,new po.default(u);return[2,a]}})})}}var r;return r=e,e.preparePreAPIHook=function(t){var i=t.recipePreAPIHook,o=t.action,n=t.options,a=t.userContext;return function(u){return Ie(void 0,void 0,void 0,function(){var c;return Se(r,function(s){switch(s.label){case 0:return[4,i(se(se({},u),{action:o,userContext:a}))];case 1:return c=s.sent(),n===void 0||n.preAPIHook===void 0?[2,c]:[2,n.preAPIHook({url:c.url,requestInit:c.requestInit,userContext:a})]}})})}},e.preparePostAPIHook=function(t){var i=t.recipePostAPIHook,o=t.action,n=t.userContext;return function(a){return Ie(void 0,void 0,void 0,function(){return Se(r,function(u){switch(u.label){case 0:return[4,i(se(se({},a),{userContext:n,action:o}))];case 1:return u.sent(),[2]}})})}},e}();en.default=mo;var wo=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},yo=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(ft,"__esModule",{value:!0}),ft.getRecipeImplementation=void 0;var jn=en;function ns(e){var r=new jn.default(e.recipeId,e.appInfo);return{getTenantId:function(){},getLoginMethods:function(t){var i=t.tenantId,o=t.options,n=t.userContext;return wo(this,void 0,void 0,function(){var a,u,c,s,l;return yo(this,function(d){switch(d.label){case 0:return a={},e.clientType!==void 0&&(a.clientType=e.clientType),[4,r.get(i,"/loginmethods",{},a,jn.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"GET_LOGIN_METHODS",options:o,userContext:n}),jn.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"GET_LOGIN_METHODS",userContext:n}))];case 1:return u=d.sent(),c=u.jsonBody,s=u.fetchResponse,c.firstFactors===void 0?(l=[],c.emailPassword.enabled&&l.push("emailpassword"),c.thirdParty.enabled&&l.push("thirdparty"),c.passwordless.enabled&&(l.push("otp-email"),l.push("otp-phone"),l.push("link-email"),l.push("link-phone"))):l=c.firstFactors,[2,{status:"OK",thirdParty:{providers:c.thirdParty.providers},firstFactors:l,fetchResponse:s}]}})})}}}ft.default=ns,ft.getRecipeImplementation=ns;var tn={},bo=p&&p.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function i(){this.constructor=r}r.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ko=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},Ro=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(tn,"__esModule",{value:!0});var Io=Ut,So=ze,To=function(e){bo(r,e);function r(t){var i=e.call(this,t)||this;return i.signOut=function(o){return ko(i,void 0,void 0,function(){return Ro(this,function(n){switch(n.label){case 0:return[4,So.default.getInstanceOrThrow().signOut({userContext:o.userContext})];case 1:return[2,n.sent()]}})})},i}return r}(Io.default);tn.default=To;var _o=p&&p.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function i(){this.constructor=r}r.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),nn=p&&p.__assign||function(){return nn=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},nn.apply(this,arguments)};Object.defineProperty(Je,"__esModule",{value:!0}),Je.Recipe=void 0;var Eo=Yt,Co=Le,Ao=ft,rs=G,Po=tn,ss=function(e){_o(r,e);function r(t){var i=e.call(this,(0,Eo.normaliseUserInput)(t))||this,o=new Co.default((0,Ao.default)({recipeId:i.config.recipeId,appInfo:i.config.appInfo,clientType:i.config.clientType,preAPIHook:i.config.preAPIHook,postAPIHook:i.config.postAPIHook}));return i.recipeImplementation=o.override(i.config.override.functions).build(),i}return r.init=function(t){return function(i,o){return r.instance=new r(nn(nn({},t),{recipeId:r.RECIPE_ID,appInfo:i,clientType:o})),r.instance}},r.getInstanceOrThrow=function(){if(r.instance===void 0){var t="No instance of Multitenancy found. Ensure that 'SuperTokens.init' method has been called.";throw t=(0,rs.checkForSSRErrorAndAppendIfNeeded)(t),Error(t)}return r.instance},r.reset=function(){(0,rs.isTest)()&&(r.instance=void 0)},r.RECIPE_ID="multitenancy",r}(Po.default);Je.Recipe=ss,Je.default=ss;var is={},os={};(function(e){function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}e.__esModule=!0,r(ve)})(os),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DateProviderReference=void 0;var r=os;Object.defineProperty(e,"DateProviderReference",{enumerable:!0,get:function(){return r.DateProviderReference}})}(is),Object.defineProperty(Nn,"__esModule",{value:!0});var $n=G,Oo=Qr,Do=pn,Mo=Qt,as=Je,xo=is,Ho=function(){function e(r){var t=this;if(this.recipeList=[],this.appInfo=(0,$n.normaliseInputAppInfoOrThrowError)(r.appInfo),r.recipeList===void 0||r.recipeList.length===0)throw new Error("Please provide at least one recipe to the supertokens.init function call. See https://supertokens.io/docs/emailpassword/quick-setup/frontend");var i=!1;r.enableDebugLogs!==void 0&&(i=r.enableDebugLogs);var o=!1;this.recipeList=r.recipeList.map(function(n){var a=n(t.appInfo,r.clientType,i);return a.config.recipeId===as.Recipe.RECIPE_ID&&(o=!0),a}),o||this.recipeList.push(as.Recipe.init()(this.appInfo,r.clientType,i))}return e.init=function(r){if(Oo.CookieHandlerReference.init(r.cookieHandler),Do.WindowHandlerReference.init(r.windowHandler),xo.DateProviderReference.init(r.dateProvider),e.instance!==void 0){console.warn("SuperTokens was already initialized");return}e.instance=new e(r),Mo.PostSuperTokensInitCallbacks.runPostInitCallbacks()},e.getInstanceOrThrow=function(){if(e.instance===void 0){var r="SuperTokens must be initialized before calling this method.";throw r=(0,$n.checkForSSRErrorAndAppendIfNeeded)(r),new Error(r)}return e.instance},e.reset=function(){if(!(0,$n.isTest)()){console.warn("Calling reset() is only supported during testing");return}e.instance=void 0},e}();Nn.default=Ho,Object.defineProperty(lt,"__esModule",{value:!0}),lt.init=void 0;var Fo=Nn,us=function(){function e(){}return e.init=function(r){Fo.default.init(r)},e}();lt.default=us,lt.init=us.init,function(e){function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}e.__esModule=!0,r(lt)}(Kr);const Lo=vn(Kr);var ht={},K={},gt={},rn={},vt=p&&p.__assign||function(){return vt=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},vt.apply(this,arguments)};Object.defineProperty(rn,"__esModule",{value:!0}),rn.normaliseUserInput=void 0;var Uo=ct;function No(e){var r=vt({functions:function(t){return t}},e.override);return vt(vt({},(0,Uo.normaliseAuthRecipe)(e)),{override:r})}rn.normaliseUserInput=No;var pt={},sn=p&&p.__assign||function(){return sn=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},sn.apply(this,arguments)},mt=p&&p.__awaiter||function(e,r,t,i){function o(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function u(l){try{s(i.next(l))}catch(d){a(d)}}function c(l){try{s(i.throw(l))}catch(d){a(d)}}function s(l){l.done?n(l.value):o(l.value).then(u,c)}s((i=i.apply(e,r||[])).next())})},wt=p&&p.__generator||function(e,r){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,o,n,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(s){return function(l){return c([s,l])}}function c(s){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(n=s[0]&2?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[s[0]&2,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return t.label++,{value:s[1],done:!1};case 5:t.label++,o=s[1],s=[0];continue;case 7:s=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(s[0]===6||s[0]===2)){t=0;continue}if(s[0]===3&&(!n||s[1]>n[0]&&s[1]<n[3])){t.label=s[1];break}if(s[0]===6&&t.label<n[1]){t.label=n[1],n=s;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(s);break}n[2]&&t.ops.pop(),t.trys.pop();continue}s=r.call(e,t)}catch(l){s=[6,l],o=0}finally{i=n=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(pt,"__esModule",{value:!0}),pt.getRecipeImplementation=void 0;var de=en,on=Je,an=G;function ls(e){var r=new de.default(e.recipeId,e.appInfo);return{submitNewPassword:function(t){var i=t.formFields,o=t.options,n=t.userContext;return mt(this,void 0,void 0,function(){var a,u,c,s,l;return wt(this,function(d){switch(d.label){case 0:return a=this.getTenantIdFromURL({userContext:n}),u=this.getResetPasswordTokenFromURL({userContext:n}),[4,r.post(a,"/user/password/reset",{body:JSON.stringify({formFields:i,token:u,method:"token"})},de.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"SUBMIT_NEW_PASSWORD",options:o,userContext:n}),de.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"SUBMIT_NEW_PASSWORD",userContext:n}))];case 1:return c=d.sent(),s=c.jsonBody,l=c.fetchResponse,s.status==="FIELD_ERROR"?[2,{status:"FIELD_ERROR",formFields:s.formFields,fetchResponse:l}]:s.status==="RESET_PASSWORD_INVALID_TOKEN_ERROR"?[2,{status:s.status,fetchResponse:l}]:[2,sn(sn({},s),{fetchResponse:l})]}})})},sendPasswordResetEmail:function(t){var i=t.formFields,o=t.options,n=t.userContext;return mt(this,void 0,void 0,function(){var a,u,c,s,l;return wt(this,function(d){switch(d.label){case 0:return l=(s=r).post,[4,on.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:n})];case 1:return[4,l.apply(s,[d.sent(),"/user/password/reset/token",{body:JSON.stringify({formFields:i})},de.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"SEND_RESET_PASSWORD_EMAIL",options:o,userContext:n}),de.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"SEND_RESET_PASSWORD_EMAIL",userContext:n})])];case 2:return a=d.sent(),u=a.jsonBody,c=a.fetchResponse,u.status==="FIELD_ERROR"?[2,{status:"FIELD_ERROR",formFields:u.formFields,fetchResponse:c}]:u.status==="PASSWORD_RESET_NOT_ALLOWED"?[2,{status:u.status,reason:u.reason,fetchResponse:c}]:[2,{status:u.status,fetchResponse:c}]}})})},signUp:function(t){var i=t.formFields,o=t.options,n=t.userContext;return mt(this,void 0,void 0,function(){var a,u,c,s,l;return wt(this,function(d){switch(d.label){case 0:return l=(s=r).post,[4,on.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:n})];case 1:return[4,l.apply(s,[d.sent(),"/signup",{body:JSON.stringify({formFields:i})},de.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"EMAIL_PASSWORD_SIGN_UP",options:o,userContext:n}),de.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"EMAIL_PASSWORD_SIGN_UP",userContext:n})])];case 2:return a=d.sent(),u=a.jsonBody,c=a.fetchResponse,u.status==="FIELD_ERROR"?[2,{status:"FIELD_ERROR",formFields:u.formFields,fetchResponse:c}]:u.status==="SIGN_UP_NOT_ALLOWED"?[2,{status:"SIGN_UP_NOT_ALLOWED",reason:u.reason,fetchResponse:c}]:[2,{status:u.status,user:(0,an.normaliseUser)("emailpassword",u.user),fetchResponse:c}]}})})},signIn:function(t){var i=t.formFields,o=t.options,n=t.userContext;return mt(this,void 0,void 0,function(){var a,u,c,s,l;return wt(this,function(d){switch(d.label){case 0:return l=(s=r).post,[4,on.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:n})];case 1:return[4,l.apply(s,[d.sent(),"/signin",{body:JSON.stringify({formFields:i})},de.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"EMAIL_PASSWORD_SIGN_IN",options:o,userContext:n}),de.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"EMAIL_PASSWORD_SIGN_IN",userContext:n})])];case 2:return a=d.sent(),u=a.jsonBody,c=a.fetchResponse,u.status==="FIELD_ERROR"?[2,{status:"FIELD_ERROR",formFields:u.formFields,fetchResponse:c}]:u.status==="WRONG_CREDENTIALS_ERROR"?[2,{status:"WRONG_CREDENTIALS_ERROR",fetchResponse:c}]:u.status==="SIGN_IN_NOT_ALLOWED"?[2,{status:"SIGN_IN_NOT_ALLOWED",reason:u.reason,fetchResponse:c}]:[2,{status:"OK",user:(0,an.normaliseUser)("emailpassword",u.user),fetchResponse:c}]}})})},doesEmailExist:function(t){var i=t.email,o=t.options,n=t.userContext;return mt(this,void 0,void 0,function(){var a,u,c,s,l;return wt(this,function(d){switch(d.label){case 0:return l=(s=r).get,[4,on.default.getInstanceOrThrow().recipeImplementation.getTenantId({userContext:n})];case 1:return[4,l.apply(s,[d.sent(),"/emailpassword/email/exists",{},{email:i},de.default.preparePreAPIHook({recipePreAPIHook:e.preAPIHook,action:"EMAIL_EXISTS",options:o,userContext:n}),de.default.preparePostAPIHook({recipePostAPIHook:e.postAPIHook,action:"EMAIL_EXISTS",userContext:n})])];case 2:return a=d.sent(),u=a.jsonBody,c=a.fetchResponse,[2,{status:u.status,doesExist:u.exists,fetchResponse:c}]}})})},getResetPasswordTokenFromURL:function(){var t=(0,an.getQueryParams)("token");return t===void 0?"":t},getTenantIdFromURL:function(){return(0,an.getQueryParams)("tenantId")}}}pt.default=ls,pt.getRecipeImplementation=ls;var qo=p&&p.__extends||function(){var e=function(r,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},e(r,t)};return function(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(r,t);function i(){this.constructor=r}r.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),un=p&&p.__assign||function(){return un=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},un.apply(this,arguments)};Object.defineProperty(gt,"__esModule",{value:!0}),gt.Recipe=void 0;var jo=rn,$o=pt,Vo=Le,cs=G,Bo=tn,ds=function(e){qo(r,e);function r(t){var i=e.call(this,(0,jo.normaliseUserInput)(t))||this,o=new Vo.default((0,$o.default)({recipeId:i.config.recipeId,appInfo:i.config.appInfo,clientType:i.config.clientType,preAPIHook:i.config.preAPIHook,postAPIHook:i.config.postAPIHook}));return i.recipeImplementation=o.override(i.config.override.functions).build(),i}return r.init=function(t){return function(i,o){return r.instance=new r(un(un({},t),{recipeId:r.RECIPE_ID,clientType:o,appInfo:i})),r.instance}},r.getInstanceOrThrow=function(){if(r.instance===void 0){var t="No instance of EmailPassword found. Ensure that the 'EmailPassword.init' method is called within the 'SuperTokens.init' recipeList.";throw t=(0,cs.checkForSSRErrorAndAppendIfNeeded)(t),Error(t)}return r.instance},r.reset=function(){(0,cs.isTest)()&&(r.instance=void 0)},r.RECIPE_ID="emailpassword",r}(Bo.default);gt.Recipe=ds,gt.default=ds;var ne=p&&p.__assign||function(){return ne=Object.assign||function(e){for(var r,t=1,i=arguments.length;t<i;t++){r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},ne.apply(this,arguments)};Object.defineProperty(K,"__esModule",{value:!0}),K.signOut=K.getTenantIdFromURL=K.getResetPasswordTokenFromURL=K.doesEmailExist=K.signIn=K.signUp=K.sendPasswordResetEmail=K.submitNewPassword=K.init=void 0;var Te=gt,Pe=G,pe=function(){function e(){}return e.init=function(r){return Te.default.init(r)},e.signOut=function(r){return Te.default.getInstanceOrThrow().signOut({userContext:(0,Pe.getNormalisedUserContext)(r==null?void 0:r.userContext)})},e.submitNewPassword=function(r){return Te.default.getInstanceOrThrow().recipeImplementation.submitNewPassword(ne(ne({},r),{userContext:(0,Pe.getNormalisedUserContext)(r.userContext)}))},e.sendPasswordResetEmail=function(r){return Te.default.getInstanceOrThrow().recipeImplementation.sendPasswordResetEmail(ne(ne({},r),{userContext:(0,Pe.getNormalisedUserContext)(r.userContext)}))},e.signUp=function(r){return Te.default.getInstanceOrThrow().recipeImplementation.signUp(ne(ne({},r),{userContext:(0,Pe.getNormalisedUserContext)(r.userContext)}))},e.signIn=function(r){return Te.default.getInstanceOrThrow().recipeImplementation.signIn(ne(ne({},r),{userContext:(0,Pe.getNormalisedUserContext)(r.userContext)}))},e.doesEmailExist=function(r){return Te.default.getInstanceOrThrow().recipeImplementation.doesEmailExist(ne(ne({},r),{userContext:(0,Pe.getNormalisedUserContext)(r.userContext)}))},e.getResetPasswordTokenFromURL=function(r){return Te.default.getInstanceOrThrow().recipeImplementation.getResetPasswordTokenFromURL(ne(ne({},r),{userContext:(0,Pe.getNormalisedUserContext)(r==null?void 0:r.userContext)}))},e.getTenantIdFromURL=function(r){return Te.default.getInstanceOrThrow().recipeImplementation.getTenantIdFromURL(ne(ne({},r),{userContext:(0,Pe.getNormalisedUserContext)(r==null?void 0:r.userContext)}))},e}();K.default=pe;var Go=pe.init;K.init=Go;var Wo=pe.submitNewPassword;K.submitNewPassword=Wo;var Xo=pe.sendPasswordResetEmail;K.sendPasswordResetEmail=Xo;var zo=pe.signUp;K.signUp=zo;var Jo=pe.signIn;K.signIn=Jo;var Ko=pe.doesEmailExist;K.doesEmailExist=Ko;var Qo=pe.signOut;K.signOut=Qo;var Yo=pe.getResetPasswordTokenFromURL;K.getResetPasswordTokenFromURL=Yo;var Zo=pe.getTenantIdFromURL;K.getTenantIdFromURL=Zo,function(e){function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}e.__esModule=!0,r(K)}(ht);const ea=vn(ht),fs=()=>{Lo.init({appInfo:{apiDomain:"http://localhost:3001",apiBasePath:"",appName:"Hacking With SuperTokens"},recipeList:[Kt.init(),ea.init()]})};var ta=tt("<button>Session Info"),na=tt("<button>Sign Out"),ra=tt("<div><h2>Dashboard</h2><div class=form-wrap part=st-dashboard>");function sa(){fs();const[e,r]=St(!0),t=async()=>{const n=await(await fetch("http://localhost:3001/sessioninfo",{headers:{"Content-Type":"application/json"},method:"GET",credentials:"include"})).json();alert(JSON.stringify(n))};async function i(){await Kt.signOut(),window.location.href="/"}return Kn(async()=>{await Kt.doesSessionExist()?r(!1):window.location.href="/"}),$e(fr,{get children(){var o=ra(),n=o.firstChild,a=n.nextSibling;return n.style.setProperty("text-align","center"),Ct(a,$e(rr,{get when(){return e()},children:"Loading..."}),null),Ct(a,$e(rr,{get when(){return!e()},get children(){return[(()=>{var u=ta();return u.$$click=t,u})(),(()=>{var u=na();return u.$$click=i,u})()]}}),null),o}})}dr("c-dashboard",{},()=>(cr(),$e(sa,{}))),ir(["click"]);var ia=tt("<div class=form-wrap part=st-email-password><input type=email placeholder=Email><input type=password placeholder=Password><button>Sign Up</button><button>Sign In");async function oa(e,r){try{let t=await ht.signUp({formFields:[{id:"email",value:e},{id:"password",value:r}]});console.log(e,r),t.status==="FIELD_ERROR"?t.formFields.forEach(i=>{(i.id==="email"||i.id==="password")&&window.alert(i.error)}):t.status==="SIGN_UP_NOT_ALLOWED"?window.alert(t.reason):window.location.href="/dashboard/"}catch(t){console.log(t),t.isSuperTokensGeneralError===!0?window.alert(t.message):window.alert("Oops! Something went wrong.")}}async function hs(e){try{return await ht.doesEmailExist({email:e})}catch(r){r.isSuperTokensGeneralError===!0?window.alert(r.message):window.alert("Oops! Something went wrong.")}}async function aa(e,r){try{let t=await ht.signIn({formFields:[{id:"email",value:e},{id:"password",value:r}]});t.status==="FIELD_ERROR"?t.formFields.forEach(i=>{i.id==="email"&&window.alert(i.error)}):t.status==="WRONG_CREDENTIALS_ERROR"?window.alert("Email password combination is incorrect."):t.status==="SIGN_IN_NOT_ALLOWED"?window.alert(t.reason):window.location.href="/dashboard/"}catch(t){t.isSuperTokensGeneralError===!0?window.alert(t.message):window.alert("Oops! Something went wrong.")}}function ua(){fs();const[e,r]=St(""),[t,i]=St(""),o=async()=>{const a=await hs(e());a!=null&&a.doesExist?window.alert("Email already exists. Please sign in instead"):oa(e(),t())},n=async()=>{const a=await hs(e());a!=null&&a.doesExist?aa(e(),t()):window.alert("Email does not exist. Please sign up instead")};return Kn(async()=>{await Kt.doesSessionExist()&&(window.location.href="/dashboard/")}),$e(fr,{get children(){var a=ia(),u=a.firstChild,c=u.nextSibling,s=c.nextSibling,l=s.nextSibling;return u.$$input=d=>r(d.target.value),c.$$input=d=>i(d.target.value),s.$$click=o,l.$$click=n,a}})}dr("c-email-password",{},()=>(cr(),$e(ua,{}))),ir(["input","click"])});
